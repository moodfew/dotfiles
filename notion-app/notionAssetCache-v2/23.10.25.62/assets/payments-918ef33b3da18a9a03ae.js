"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[983],{80567:(e,t,r)=>{r.d(t,{a:()=>o});var a=r(19234),i=r(61269);async function o(e,t){const r=(0,a.gq)(t);if("skip"===r)return{valid:!0};if("insufficient_data"===r)return{valid:!1};const o=await(0,i.resolveAddress)(e,{address:{line1:t.addressLine1,city:t.city,zip:t.zipCode,state:t.state,country:t.country}});return"failed"===o.type?{valid:!1}:o.data}},27386:(e,t,r)=>{r.d(t,{Z:()=>p});var a=r(77094),i=r.n(a),o=(r(67294),r(83355)),s=r(29368),n=r(592),d=r(80172);class l extends o.Z{static renderDivider(){return i()(s.Z,{size:37})}renderComponent(){const{device:e}=this.environment,{children:t,controlRow:r,paddingLeftRight:a}=this.props,o=()=>a||(e.isMobile?18:60),s=()=>e.isMobile?18:36;return this.props.disableScroller?i()("div",{style:{paddingLeft:o(),paddingRight:o()}},void 0,i()("div",{style:{paddingTop:s(),paddingBottom:s()}},void 0,t),r&&i()("div",{style:{paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,r)):i()("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",backgroundColor:this.theme.cardContentBackground}},void 0,i()(n.Z,{type:d.Z.All,style:{flexGrow:1,WebkitOverflowScrolling:"touch",transform:"translateZ(0)",paddingLeft:o(),paddingRight:o(),paddingTop:s(),paddingBottom:s()}},void 0,t),r&&i()("div",{style:{flexGrow:0,flexShrink:0,paddingLeft:o(),paddingRight:o(),paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,r))}}const p=l},93039:(e,t,r)=>{r.d(t,{J:()=>w});var a=r(97464),i=r.n(a),o=r(77094),s=r.n(o),n=(r(33948),r(67294)),d=r.n(n),l=r(480),p=r(24405),c=r(31942),u=r(59054),m=r(97880),g=r(5366),y=r(50906),v=r(61269),h=r(80366),f=r(27242),b=r(48762),S=r(62727),M=r(71202),C=r(25584),x=r(66722),Z=r(83071);function w(e){const t=(0,p.y)((e=>({container:(0,h.s)(e),cityZipRow:{display:"flex"},verticalDivider:{display:"flex",borderLeft:"1px solid",borderLeftColor:e.groupedFormBorder},zipRow:{display:"flex",flex:2},stateRow:{display:"flex",flex:3}})),[]),r=(0,g.useIntl)(),a=(0,l.O7)();return s()("div",{},void 0,s()("div",{style:t.container},void 0,s()(T,{placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.fullName",defaultMessage:"Full name"}),address:e.address,updateAddress:e.updateAddress,addressKey:"name",environment:a}),e.shouldShowBusinessName&&s()(T,{placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.businessName",defaultMessage:"Business name (optional)"}),address:e.address,updateAddress:e.updateAddress,addressKey:"businessName",environment:a}),s()(P,{updateAddress:e.updateAddress,address:e.address}),e.address&&d().createElement(d().Fragment,null,s()(T,{placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.address",defaultMessage:"Address"}),address:e.address,addressKey:"addressLine1",updateAddress:e.updateAddress,environment:a}),s()(T,{placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.city",defaultMessage:"City"}),addressKey:"city",address:e.address,updateAddress:e.updateAddress,environment:a}),s()("div",{style:t.cityZipRow},void 0,s()("div",{style:t.zipRow},void 0,s()(T,{placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.zipCode",defaultMessage:"Zip code"}),address:e.address,addressKey:"zipCode",updateAddress:e.updateAddress,environment:a})),s()("div",{style:t.verticalDivider}),s()("div",{style:t.stateRow},void 0,s()(T,{placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.state",defaultMessage:"State / Province"}),address:e.address,addressKey:"state",updateAddress:e.updateAddress,environment:a}))))))}function P(e){const t=(0,l.O7)(),[r,a]=(0,n.useState)(!1),o=(0,g.useIntl)(),w=(0,p.y)((()=>({input:{background:"none",boxShadow:"none",padding:8}})),[]),[P,T]=d().useState(""),[A]=(0,u.r5)((async()=>{const e=await v.getAvailableCountries(t,{});return"success"===e.type?e.data.countries:"failed"===e.type?[]:void(0,m.t1)(e)}),[t]),F=A.value;if(!F)return null;const B=(0,c.ZP)(P,F,(e=>e.name)).map(((r,o)=>({key:o,render:e=>d().createElement(b.Z,i()({},e,{title:r.name})),action:()=>{r.countryCode!==e.address.country&&e.updateAddress({addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:r.countryCode});const i=f.Z.state;i.open&&f.Z.setState({...i,vatApplicable:Boolean(r.vatApplicable)}),T(r.name),a(!1),(0,y.rYO)(t,{addressType:"country",addressUpdate:r.name})}})));return s()(h.c,{},void 0,s()(x.ZP,{popupType:x.ZP.PopupType.Popup,alignmentToOrigin:x.ZP.Alignment.End,placementToOrigin:x.ZP.Placement.Right,originGap:0,open:r,origin:s()(S.Z,{value:P,focus:r,placeholder:o.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.country",defaultMessage:"Country or region"}),style:w.input,onChange:t=>{T(t.target.value),e.updateAddress({country:void 0})},onFocus:()=>{a(!0)}}),onDismiss:()=>{a(!1)},render:()=>s()(M.ZP,{menuType:M.ZP.MenuType.Popup,width:"100%"},void 0,s()(C.Z,{type:C.Z.Type.Vertical,initialFocus:P.length>0?0:void 0,sections:[{key:0,showNoResultMessage:!0,render:e=>d().createElement(Z.Z,i()({},e,{title:s()(g.FormattedMessage,{id:"spaceSubscriptionBillingInfoForm.countryDropdown.title",defaultMessage:"Select a country or region"})})),items:B}]}))}))}function T(e){const t=(0,p.y)((()=>({input:{background:"none",boxShadow:"none",padding:8}})),[]);return s()(h.c,{},void 0,s()(S.Z,{value:e.address[e.addressKey],style:t.input,placeholder:e.placeholder,onChange:(r=e.updateAddress,a=e.addressKey,i=e.environment,e=>{(0,y.rYO)(i,{addressType:a,addressUpdate:e.target.value}),r({[a]:e.target.value})})}));var r,a,i}},10644:(e,t,r)=>{r.d(t,{Z:()=>p});var a=r(77094),i=r.n(a),o=(r(67294),r(83355)),s=r(5366),n=r(27386),d=r(46951);class l extends o.Z{renderComponent(){return i()(n.Z,{},void 0,i()(d.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,i()(s.FormattedMessage,{id:"spaceSubscriptionPlans.offlineMessage",defaultMessage:"Please go online to manage your plan."})))}}const p=l},83516:(e,t,r)=>{r.r(t),r.d(t,{default:()=>xe});var a=r(97464),i=r.n(a),o=r(77094),s=r.n(o),n=r(77422),d=r.n(n),l=(r(33948),r(86664)),p=r(67294),c=r.n(p),u=r(83355),m=r(8848),g=r(64875),y=r(3779),v=r(90850),h=r(60897),f=r(19889),b=r(58059),S=r(97880),M=r(82990),C=r(5366),x=r(80567),Z=r(50906),w=r(21325),P=r(19234),T=r(1643),A=r(27242),F=r(78291),B=r(61269);async function U(e){const t=A.Z.state,r=F.default.state.data;if(!t.open||!r)return;if(t.vatApplicable&&t.temporaryVatCode)return void A.Z.setState({...t,taxAmount:void 0,calculatingTax:!1});const a=t.temporaryAddress;if("insufficient_data"===(0,P.gq)(a))return;A.Z.setState({...t,calculatingTax:!0});const{planAmount:i,promoInfo:o,creditAmount:s,accountBalance:n}=(0,T.uN)({state:t,promo:t.appliedPromo,data:r}),d=await(0,B.calculateTax)(e,{address:a,price:Math.max(0,i-o.amount-s+n),vatId:t.vatApplicable?t.temporaryVatCode:void 0});if("failed"===d.type)A.Z.setState({...t,taxAmount:void 0,calculatingTax:!1});else{const e=d.data;e.valid?A.Z.setState({...t,taxAmount:e.taxAmount,calculatingTax:!1}):A.Z.setState({...t,taxAmount:void 0,calculatingTax:!1})}}var k=r(16100),I=r(27832),z=r(88632),_=r(66205),E=r(45407),D=r(92083),L=r(72693),O=r(48762),R=r(46167),N=r(69972),W=r(71202),H=r(25584),Y=r(15102),V=r(47966),q=r(83328),K=r(592),j=r(83071),G=r(96486),Q=r(480),X=r(28350),J=r(24405),$=r(80366),ee=r(62727),te=r(93039);function re(e){const t=(0,J.y)((e=>({container:(0,$.s)(e),header:se(e),cityZipRow:{display:"flex"},verticalDivider:{display:"flex",borderLeft:"1px solid",borderLeftColor:e.groupedFormBorder},zipRow:{display:"flex",flex:2},stateRow:{display:"flex",flex:3}})),[]),r=(0,Q.O7)(),[a]=(0,p.useState)((()=>(0,G.debounce)((async()=>{await U(r)}),3e3))),[i]=(0,X.oR)(A.Z);if(!i.open)return null;const o=i.temporaryAddress;return s()("div",{},void 0,s()("label",{style:t.header},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionPaymentForm.billingInformation.header",defaultMessage:"Billing information"})),s()(te.J,{address:o,updateAddress:async e=>{A.Z.setAddressField(e),await a()},shouldShowBusinessName:["team","enterprise"].includes(e.storeState.subscriptionTier)}),s()(ae,{storeState:e.storeState}),s()(ie,{onUpdate:async()=>{await a()}}))}function ae(e){const t=(0,J.y)((t=>({container:{...oe(t),padding:"5px 5px 5px 10px"},header:{...se(t),paddingTop:20},wrapper:{..."credit_card"!==e.storeState.temporaryPaymentMethod?{display:"none"}:void 0}})),[e.storeState.temporaryPaymentMethod]),r=(0,J.F)(),[a]=(0,X.oR)(A.Z);return a.open?s()("div",{style:t.wrapper},void 0,s()("label",{style:t.header},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionPaymentForm.paymentInformation.header",defaultMessage:"Payment information"})),s()("div",{style:t.container},void 0,s()(l.CardElement,{options:{disabled:"disabled"===a.payButtonState,style:{base:{iconColor:r.blueColor,color:r.regularTextColor,fontFamily:M.Z.baseFontFamily.sans,fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:r.lightTextColor},lineHeight:"2em"},complete:{iconColor:r.blueColor},invalid:{color:m.ZP.red,iconColor:m.ZP.red}},hidePostalCode:!0}}))):null}function ie(e){const t=(0,J.y)((e=>({container:{...oe(e),borderBottom:"none"},header:{...se(e),paddingTop:20},input:{background:"none",boxShadow:"none",padding:8},subtitle:{color:e.mediumTextColor,fontSize:M.Z.fontSize.UISmall.desktop,marginTop:5,marginBottom:10}})),[]),r=(0,C.useIntl)(),[a,i]=(0,X.oR)(A.Z);return a.open&&a.vatApplicable?s()("div",{},void 0,s()("label",{style:t.header},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionPaymentForm.vatCountryCode.header",defaultMessage:"VAT (optional)"})),s()("div",{style:t.container},void 0,s()($.c,{},void 0,s()(ee.Z,{value:a.temporaryVatCode,style:t.input,placeholder:r.formatMessage({id:"spaceSubscriptionPaymentForm.vatCountryCode.placeholder",defaultMessage:"VAT/GST number"}),onChange:t=>{i({...a,temporaryVatCode:t.target.value}),e.onUpdate(t.target.value)}}))),s()("div",{style:t.subtitle},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionBilling.vatCountryCode.subtitle",defaultMessage:"Please include your country code"}))):null}function oe(e){return{backgroundColor:e.cardContentBackground,borderWidth:1,borderStyle:"solid",borderColor:e.groupedFormBorder,borderRadius:3}}function se(e){return{display:"flex",alignItems:"center",marginBottom:6,fontSize:12,fontWeight:M.Z.fontWeight.semibold,color:e.mediumTextColor}}var ne=r(10644),de=r(32056),le=r(47714);function pe(e){const[t,r]=(0,X.oR)(A.Z),a=(0,J.y)(ce,[]),i=(0,Q.O7)(),o=(0,C.useIntl)();return!t.open||e.data.availableCredit<=0?null:s()("div",{style:a.toggle,onClick:()=>{!function(e){const{data:t,state:r,setModalState:a,environment:i}=e,o=void 0===r.temporaryUseCreditCents||r.temporaryUseCreditCents===t.availableCredit?0:t.availableCredit;a({...r,temporaryUseCreditCents:o}),Z.Jy$(i,{credits:o})}({environment:i,data:e.data,state:t,setModalState:r})}},void 0,s()("div",{style:{marginRight:8}},void 0,s()(C.FormattedMessage,{id:"applyCreditToggle.applyCredit.amount",defaultMessage:"Apply {creditAmount} credit",description:"Whether to apply credit to this subscription. The amount is formatted with currency",values:{creditAmount:(0,de.Dx)({amount:e.data.availableCredit,currency:"dollar",intl:o})}})),s()(le.Z,{on:(0,T.Ry)(t,e.data)===e.data.availableCredit}))}function ce(e){return{toggle:{cursor:"pointer",fontSize:14,color:e.regularTextColor,display:"flex",justifyContent:"space-between",marginTop:14,marginBottom:7}}}var ue=r(29368),me=r(68932),ge=r(1063);function ye(e){const{state:t,data:r,promo:a}=e,i=(0,J.y)((e=>({container:{display:"flex",flexDirection:"column"},header:{fontSize:16,color:e.regularTextColor,fontWeight:M.Z.fontWeight.semibold,marginBottom:10},couponLink:{fontSize:12}})),[]);return s()("div",{style:i.container},void 0,s()("label",{style:i.header},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.header",defaultMessage:"Order summary"})),s()(be,{state:t,data:r,promo:a}),T.Fu(t.subscriptionTier)&&s()(ge.X,{tier:t.subscriptionTier}),0!==r.availableCredit&&c().createElement(c().Fragment,null,s()(pe,{data:r}),s()(ue.Z,{size:14})),s()(he,{style:{marginTop:0===r.availableCredit?14:0},state:t,data:r,promo:a}),s()(ue.Z,{size:14}),s()(ve,{state:t,data:r,promo:a}))}function ve(e){const{state:t,data:r,promo:a}=e,{payAmount:i}=T.uN({state:t,promo:a,data:r});return s()(fe,{lineItem:{price:i,type:"standard",name:s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeOrderSummary.orderTotal",defaultMessage:"Total"})},priceStyle:{fontSize:20}})}function he(e){const{state:t,data:r,promo:a,style:i}=e,{lineItems:o}=T.uN({state:t,promo:a,data:r}),n=o.map((e=>s()(fe,{lineItem:e},"".concat(e.name,":").concat(e.price,":").concat(e.type))));return s()("div",{style:i},void 0,n)}function fe(e){const{lineItem:t,priceStyle:r}=e,a=(0,J.y)((e=>({container:{marginTop:24},itemContainer:{display:"flex",justifyContent:"space-between",alignItems:"baseline",lineHeight:1.7},name:{fontSize:14,color:e.mediumTextColor},price:{fontSize:14,color:"promotion"===t.type?"#53A83F":e.regularTextColor,...r||void 0},caption:{fontSize:12,color:e.mediumTextColor},captionContainer:{display:"flex",flexDirection:"column"}})),[t,r]),i=(0,C.useIntl)(),o=t.price?(0,de.Dx)({amount:t.price,currency:"dollar",intl:i}):"—";return s()("div",{style:a.itemContainer},void 0,s()("div",{style:a.captionContainer},void 0,s()("span",{style:a.name},void 0,t.name),t.subtitle&&s()("span",{style:a.caption},void 0,t.subtitle)),"calculating"===t.type?s()(me.Z,{}):s()("span",{style:a.price},void 0,o))}function be(e){const{state:t,data:r,promo:a}=e,i=(0,C.useIntl)(),o=function(e,t){const{subscriptionTier:r}=e,a=T.su(t);switch(r){case"personal":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.personalPlan",defaultMessage:"Personal pro plan"});case"team":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.teamPlan",defaultMessage:"Team plan ({numberOfMembers, plural, one {# member} other {# members}})",values:{numberOfMembers:a}});case"business":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.businessPlan",defaultMessage:"Business plan ({numberOfMembers, plural, one {# member} other {# members}})",description:"Summarizes the business plan type a user is trying to upgrade to.",values:{numberOfMembers:a}});case"enterprise":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.enterprisePlan",defaultMessage:"Enterprise plan ({numberOfMembers, plural, one {# member} other {# members}})",values:{numberOfMembers:a}});default:(0,S.t1)(r)}}(t,r),n=function(e,t){const{subscriptionTier:r}=e,a=T.GD(e),i=T._B({subscriptionTier:r,billingInterval:a,intl:t});switch(a){case"year":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.planSubtitle.billedYearly",defaultMessage:"{price} / user / month · Billed yearly",values:{price:i}});case"month":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.orderSummary.planSubtitle.billedMonthly",defaultMessage:"{price} / user / month · Billed monthly",values:{price:i}});default:(0,S.t1)(a)}}(t,i),{planAmount:d}=T.uN({state:t,promo:a,data:r}),l=(0,J.y)((e=>({container:{display:"flex",justifyContent:"space-between",marginBottom:6},item:{},title:{fontSize:14},subtitle:{color:e.mediumTextColor,fontSize:12},price:{fontSize:14}})),[]);return s()("div",{style:l.container},void 0,s()("div",{style:l.item},void 0,s()("div",{style:l.title},void 0,o),s()("div",{style:l.subtitle},void 0,n)),s()("div",{style:l.price},void 0,(0,de.Dx)({amount:d,currency:"dollar",intl:i})))}var Se=r(80172),Me=r(46951);class Ce extends u.Z{constructor(){super(...arguments),d()(this,"storeTypes",{paymentOptionAvailabilityStore:E.Z}),d()(this,"renderModal",(()=>{const e=A.Z.state;if(e.open)return z.Z.state.online?s()("div",{style:this.getModalStyle()},void 0,s()("div",{style:{flex:1,maxWidth:"60%",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:"1px solid ".concat(this.theme.lightDividerColor),padding:"32px 32px 0px",display:"flex",flexDirection:"column",position:"relative"}},void 0,s()(K.Z,{type:Se.Z.Y,showScrollToBottomIndicator:!0},void 0,this.renderPlanHeader(e),this.renderBillingIntervalSection(e),this.renderPaymentMethodSection(e),s()(re,{storeState:e}))),s()("div",{style:{flex:1,maxWidth:"40%",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:"1px solid ".concat(this.theme.lightDividerColor),padding:"24px 20px 0px",display:"flex",flexDirection:"column",overflow:"scroll"}},void 0,s()(K.Z,{type:Se.Z.Y},void 0,s()(ye,{state:e,data:this.props.data,promo:e.appliedPromo}),this.renderControls(e)))):s()(ne.Z,{})})),d()(this,"validateAddress",(async e=>{const t=e.temporaryAddress,r=await(0,x.a)(this.environment,t);return r.valid&&r.validatedAddresses&&A.Z.setState({...e,temporaryAddress:{...e.temporaryAddress,...r.validatedAddresses[0]}}),"CA"===t.country?{valid:!0}:(r.valid||(t.country?A.Z.setState({...e,error:this.props.intl.formatMessage({id:"spaceSubscriptionUpgradeModal.billingAddress.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})}):A.Z.setState({...e,error:this.props.intl.formatMessage({id:"spaceSubscriptionUpgradeModal.billingAddress.missingCountryError",defaultMessage:"Invalid country. Please select the country from the dropdown menu."})}),Z.VQs(this.environment,{error:void 0,error_type:"address"})),r)})),d()(this,"handleModalClose",(()=>{A.Z.reset(),(0,Z.Xov)(this.environment)}))}didMount(){if(!A.Z.state.open)return;const{currentUserStore:e}=I.default.state;if(e&&e.state.value){const t=(0,f.Nz)(this.props.intl,e.state.value);A.Z.setState({...A.Z.state,temporaryAddress:{...A.Z.state.temporaryAddress,name:t}}),"subscribed_admin"!==this.props.data.type&&"unsubscribed_admin"!==this.props.data.type||A.Z.setState({...A.Z.state,appliedPromo:this.props.data.customerData.stripe.promo})}}didUpdate(e){if(this.props.stripe&&!e.stripe){const e=this.props.stripe.paymentRequest({country:"US",currency:"usd",total:{label:this.props.intl.formatMessage({id:"spaceSubscriptionUpgradeModal.applePay.total.label",defaultMessage:"Notion - You will be charged on a recurring basis"}),amount:0}});e.canMakePayment().then((t=>{t&&(this.stores.paymentOptionAvailabilityStore.setState({...this.stores.paymentOptionAvailabilityStore.state,supportsApplePay:t.applePay,paymentRequest:e}),this.stores.paymentOptionAvailabilityStore.addPaymentOption("native_payment_platform"))})),e.on("token",(async e=>{const t=A.Z.state;if(!t.open)return;const{valid:r}=await this.validateAddress(t);r?this.handleUpgrade(e.token.id,e.complete):e.complete("fail")}))}}renderComponent(){return s()(Y.Z,{open:A.Z.state.open,preventHideChildrenWhileOpening:!0,render:()=>s()(N.Z,{capture:!0,allowEsc:!0,render:()=>this.renderModal()}),onDismiss:this.handleModalClose})}renderPlanHeader(e){return c().createElement(c().Fragment,null,y.Z.notionLogoStroked({width:34,height:34,marginBottom:14}),s()("div",{style:{...this.getPrimaryTextStyle(),marginBottom:6}},void 0,this.getPlanTitle(e)),s()("div",{style:this.getSecondaryTextStyle()},void 0,this.getOneLiner(e)))}getOneLiner(e){switch(e.subscriptionTier){case"personal":return s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.oneLiner.personal",defaultMessage:"For power users who want to do even more."});case"team":return s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.oneLiner.team",defaultMessage:"Write, plan, and work together in one spot."});case"enterprise":return s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.oneLiner.enterprise",defaultMessage:"Controls and support to run your company."})}}getPlanTitle(e){return{personal:s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.title.personal",defaultMessage:"Upgrade to Personal Pro"}),team:s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.title.team",defaultMessage:"Upgrade to Team"}),business:s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlan",defaultMessage:"Upgrade to Business Plan",description:"Shown when a user is going to upgrade to a business plan type."}),enterprise:s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.title.enterprise",defaultMessage:"Upgrade to Enterprise"}),team_free:s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.title.teamFree",defaultMessage:"Upgrade to Team Trial"})}[e.subscriptionTier]}renderControls(e){return c().createElement(c().Fragment,null,this.renderUpgradeButton(e),this.renderErrorMessage(e),this.renderContactSales(e))}renderContactSales(e){if(!(b.rC[e.subscriptionTier]<b.rC.team))return c().createElement(c().Fragment,null,s()(V.Z,{style:{width:"100%",height:40,marginTop:10},onClick:()=>{const{currentUserStore:e}=I.default.state,t=e&&e.getValue();_.Z.setState({open:!0,email:t&&t.email,name:t&&(0,f.Nz)(this.props.intl,t)}),Z.Zbu(this.environment)}},void 0,y.Z.chat({height:18,width:20,marginRight:6}),s()("span",{style:{fontWeight:M.Z.fontWeight.medium}},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionSettings.upgradeModal.contactSales",defaultMessage:"Contact sales"}))),s()("p",{style:{color:this.theme.mediumTextColor,fontSize:12,lineHeight:M.Z.lineHeight.UISmall.desktop}},void 0,s()(C.FormattedMessage,{id:"spaceSubscriptionSettings.upgradeModal.sales.questions",defaultMessage:"Questions? Contact our sales team for more information."})))}renderErrorMessage(e){const t=e.error;if(t)return s()(Me.Z,{isMultiline:!0,style:{marginTop:8,color:m.ZP.red}},void 0,t)}renderUpgradeButton(e){const t=e.temporaryPaymentMethod,r={width:"100%",height:40,marginTop:24};return this.stores.paymentOptionAvailabilityStore.state.supportsApplePay&&"native_payment_platform"===t?s()("button",{style:{...r,WebkitAppearance:"-apple-pay-button"},onClick:()=>this.handleUpgradeClick(e)}):s()(L.Z,{disabled:"disabled"===e.payButtonState,style:r,onClick:()=>this.handleUpgradeClick(e)},void 0,this.getUpgradeButtonText(e))}getUpgradeButtonText(e){const{subscriptionTier:t}=e;switch(t){case"personal":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.upgradeButton.personalProPlan",defaultMessage:"Upgrade to Personal Pro"});case"team":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.upgradeButton.teamPlan",defaultMessage:"Upgrade to Team"});case"business":return s()(C.FormattedMessage,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlan",defaultMessage:"Upgrade to Business Plan",description:"Shown when a user is going to upgrade to a business plan type."});case"enterprise":return s()(C.FormattedMessage,{id:"spaceSubscriptionUpgradeModal.upgradeButton.enterprisePlan",defaultMessage:"Upgrade to Enterprise"});default:(0,S.t1)(t)}}renderBillingIntervalSection(e){const t=e.appliedPromo,{yearlyUnitPrice:r,monthlyUnitPrice:a}=T.uN({state:e,promo:t,data:this.props.data}),o=T.GD(e),n=1-r/(12*a),d=T.x7(e.subscriptionTier,n,this.props.intl),l=d.find((e=>e.id===o))||d[0],p=s()(C.FormattedMessage,{id:"spaceSubscriptionSettings.upgradeModal.billingIntervalSection.header",defaultMessage:"Billing interval"});return s()("div",{style:this.getSectionStyle()},void 0,s()("div",{style:this.getSubheaderStyle()},void 0,s()("div",{},void 0,p)),s()(R.Z,{popupType:R.Z.PopupType.Popup,placementToOrigin:R.Z.Placement.Bottom,sameWidthAsOrigin:!0,renderOrigin:e=>c().createElement(V.Z,i()({},e,{isLarge:!0,style:{marginBottom:4,width:"100%",justifyContent:"space-between"}}),l.title,y.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),render:t=>{const r={menuType:W.ZP.MenuType.Popup,width:"100%"},a=d.map((r=>({key:r.id,action:r=>{const a=d[r.index].id;A.Z.setState({...e,temporaryBillingInterval:a}),Z.FRI(this.environment,{billingInterval:a}),U(this.environment),t.close()},render:e=>c().createElement(O.Z,i()({},e,{title:r.title}))})));return c().createElement(W.ZP,r,s()("div",{style:{width:"100%"}},void 0,s()(H.Z,{type:H.Z.Type.Vertical,sections:[{key:"billing interval section",render:e=>c().createElement(j.Z,e),items:a}],initialFocus:void 0})))}}))}renderPaymentMethodSection(e){const t=e.temporaryPaymentMethod,r=s()(C.FormattedMessage,{id:"spaceSubscriptionSettings.upgradeModal.paymentMethodSection.header",defaultMessage:"Payment method"}),a=T.zt(this.stores.paymentOptionAvailabilityStore.state.availablePaymentMethods);return s()("div",{style:this.getSectionStyle()},void 0,s()("div",{style:this.getSubheaderStyle()},void 0,s()("div",{},void 0,r)),1===a.length?c().createElement(c().Fragment,null,s()("div",{style:{display:"flex",alignItems:"center",fontSize:14}},void 0,a[0].title),s()("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginLeft:24,marginTop:2,marginBottom:8}},void 0,a[0].caption)):a.map((r=>{let{type:a,title:i,caption:o}=r;return s()(c().Fragment,{},a,this.renderRadioButton({title:i,caption:o,isSelected:t===a,onClick:()=>{const t={...e,temporaryPaymentMethod:a};A.Z.setState(t),Z.ieb(this.environment,{paymentMethod:a})},unavailable:!1}))})))}renderRadioButton(e){const{title:t,caption:r,isSelected:a,onClick:i,unavailable:o}=e,n=o?.4:1;return s()("div",{style:{cursor:"pointer",opacity:n},onClick:i},void 0,s()("div",{style:{display:"flex",alignItems:"center",fontSize:14}},void 0,s()(q.Z,{isSelected:a}),t),s()("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginLeft:24,marginTop:2,marginBottom:8}},void 0,r))}async handleUpgradeClick(e){const t=e.temporaryPaymentMethod;Z.PNo(this.environment,{paymentMethod:t});const r=this.stores.paymentOptionAvailabilityStore.state.paymentRequest;if("native_payment_platform"===t&&r)return void r.show();A.Z.setState({...e,payButtonState:"disabled"});const{valid:a}=await this.validateAddress(e);a&&await this.handleNonNativeUpgrade(e);const i=A.Z.state;i.open&&A.Z.setState({...i,payButtonState:"enabled"})}async handleNonNativeUpgrade(e){if("invoice"===e.temporaryPaymentMethod)return await this.handleUpgrade(void 0,void 0);const{stripe:t,elements:r}=this.props;if(!r||!t)return void g.log({level:"error",from:"SpaceSubscriptionUpgradeModal",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const a=r.getElement(l.CardElement);if(!a)return void g.log({level:"error",from:"SpaceSubscriptionUpgradeModal",type:"StripeError",error:{miscDataString:"Stripe Card Element could not be found"}});const i=await t.createToken(a);if(!i.error&&i.token){const e=i.token.id;await this.handleUpgrade(e,void 0)}else i.error?(Z.VQs(this.environment,{error:i.error.message,error_type:"credit_card"}),A.Z.setState({...e,error:k.translateStripeError(this.environment,this.props.intl,i.error)})):(Z.VQs(this.environment,{error:"could not create token",error_type:"credit_card"}),A.Z.setState({...e,error:this.props.intl.formatMessage({id:"spaceSubscriptionUpgradeModal.creditCard.genericError",defaultMessage:"Your card could not be processed. Please try again."})}))}async handleUpgrade(e,t){const r=A.Z.state;if(!r.open)return void(t&&t("fail"));const a=r.temporaryPaymentMethod,{spaceStore:i,data:o}=this.props,s=T.GD(r),n=T.Ry(r,o),d=T.Md(r,o),l=h.HA[r.subscriptionTier][s],p=r.appliedPromo,c=r.temporaryAddress;await(0,w.Mg)({environment:this.environment,spaceStore:i,plan:l,stripeToken:e,billingEmail:d,creditAmount:n,coupon:p&&"coupon"===p.source?p.code:void 0,customerName:c.name,businessName:c.businessName,addressLine1:c.addressLine1,addressCity:c.city,addressZip:c.zipCode,addressState:c.state,addressCountry:c.country,vatId:r.vatApplicable?r.temporaryVatCode:void 0,promoCodeId:p&&"promo_code"===p.source?p.code:void 0})?(Z.fZH(this.environment,{paymentMethod:a}),t&&t("success"),p&&(0,v.$r)(this.environment.currentUser.id),this.handleModalClose(),D.ZP.setState({...D.ZP.state,currentTab:"billing"})):(Z.cYL(this.environment),t&&t("fail"))}getPrimaryTextStyle(){return{fontWeight:M.Z.fontWeight.bold,fontSize:22,lineHeight:1.1,marginBottom:2}}getSecondaryTextStyle(){return{fontWeight:M.Z.fontWeight.regular,fontSize:14,lineHeight:1.4,marginBottom:22,color:this.theme.mediumTextColor}}getModalStyle(){return{background:this.theme.popoverBackground,borderRadius:3,width:650,maxHeight:760,height:"100vh",display:"flex"}}getSectionStyle(){return{marginBottom:20}}getSubheaderStyle(){return{display:"flex",alignItems:"center",marginBottom:6,fontSize:12,fontWeight:M.Z.fontWeight.semibold,color:this.theme.mediumTextColor}}}const xe=(0,k.injectStripe)((0,C.injectIntl)(Ce))},1063:(e,t,r)=>{r.d(t,{X:()=>c});var a=r(77094),i=r.n(a),o=(r(67294),r(480)),s=r(24405),n=r(5366),d=r(50906),l=r(1643),p=r(42402);function c(e){const t=(0,o.O7)(),r=(0,s.y)((()=>({couponLink:{fontSize:12}})),[]);return i()(p.Z,{href:"https://notionup.typeform.com/to/qYXezfBW",external:!0,style:r.couponLink,onClick:()=>{const r=l.CM(t);d.sS1(t,{tier:e.tier,currentTier:r})}},void 0,i()("div",{},void 0,i()(n.FormattedMessage,{id:"startupCouponInlineLink.text",defaultMessage:"Are you a startup?",description:"Shown in our billing/upgrade settings to ask if a user's workspace belongs to a startup."})))}},80366:(e,t,r)=>{r.d(t,{s:()=>s,c:()=>n});var a=r(77094),i=r.n(a),o=(r(67294),r(24405));function s(e){return{backgroundColor:e.groupedFormBackground,borderWidth:1,borderStyle:"solid",borderColor:e.groupedFormBorder,borderRadius:3,borderBottomWidth:0}}function n(e){const t=(0,o.y)((t=>({group:{display:"flex",borderBottomColor:t.groupedFormBorder,borderBottomWidth:1,borderBottomStyle:"solid",alignItems:"center",flex:1,...e.style}})),[e.style]);return i()("div",{style:t.group},void 0,e.children)}},16100:(e,t,r)=>{r.r(t),r.d(t,{injectStripe:()=>u,getStripe:()=>m,translateStripeError:()=>g});var a=r(77094),i=r.n(a),o=r(86664),s=r(97894),n=r(67294),d=r.n(n),l=r(50906),p=r(95477);let c=null;function u(e){return t=>i()(o.Elements,{stripe:m()},void 0,i()(o.ElementsConsumer,{},void 0,(r=>{let{stripe:a,elements:i}=r;const o={...t,stripe:a,elements:i};return d().createElement(e,o)})))}async function m(){return c||(s.loadStripe.setLoadParameters({advancedFraudSignals:!1}),c=(0,s.loadStripe)(p.default.stripe.key)),c}function g(e,t,r){if(!r.code)return r.message||"";switch((0,l._qN)(e,{error:r.code,stripe_decline_code:r.decline_code}),r.code){case"invalid_expiry_year_past":return t.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return t.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return t.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,t){switch(t){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card.",description:"Shown as an error message if a user's card was declined."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number.",description:"Shown as an error message if a user's card was declined."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds.",description:"Shown as an error message if a user's card was declined."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number",description:"Shown as an error message if a user's card was declined."});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed.",description:"Shown as an error message if a user's card was declined."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined.",description:"Shown as an error message if a user's card was declined."})}}(t,r.decline_code);default:return r.message||""}}},45407:(e,t,r)=>{r.d(t,{Z:()=>n});r(33948);var a=r(96486),i=r.n(a),o=r(49085);class s extends o.Z{getInitialState(){return{availablePaymentMethods:["credit_card"],paymentRequest:void 0,supportsApplePay:!1}}isPaymentOptionAvailable(e){return this.state.availablePaymentMethods.includes(e)}addPaymentOption(e){const t=i().uniq([...this.state.availablePaymentMethods,e]);this.setState({...this.state,availablePaymentMethods:t})}}const n=s},19234:(e,t,r)=>{r.d(t,{gq:()=>a});r(96486);function a(e){return e.country&&(t=e.country,!["US","CA"].includes(t))?"skip":e.addressLine1&&e.zipCode||e.addressLine1&&e.city&&e.state||e.zipCode?"should_resolve":"insufficient_data";var t}}}]);