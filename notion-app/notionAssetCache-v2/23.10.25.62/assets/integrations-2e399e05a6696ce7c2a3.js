"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[801],{47836:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O,LinkPreviewLab:()=>z});var a=r(97464),i=r.n(a),n=r(77094),o=r.n(n),l=(r(33948),r(67294)),s=r.n(l),d=r(480),u=r(28350),c=r(24405),p=r(63123),g=r(3779),m=r(89602),v=r(70203),f=r(97880),y=r(82990),h=r(44876),b=r(36054),_=r(5366),x=r(45016),M=r(43250),F=r(91996),I=r(65270),w=r(27832),k=r(61766),S=r(30874),R=r(3403),Z=r(14947),T=r(48762),C=r(46167),P=r(29823),E=r(97812),B=r(53470),V=r(67206),A=r(62727),U=r(71202),D=r(25584),q=r(47966),N=r(83071),L=r(17970);function O(e){const t=(0,d.O7)(),{integrationPointer:r}=e,a=(0,u.VK)((()=>w.default.state.currentUserStore),[]),i=(0,u.VK)((()=>{if(a)return a.getRecordValue(r)}),[a,r]),n=(0,p.V)({value:i,waitTimeInMs:5e3});return"pending"===n.status?o()(R.Z,{}):"rejected"===n.status||"external"!==(null==n?void 0:n.value.type)?o()(P.Z,{}):o()(E.Z,{className:M.hE,title:o()(_.FormattedMessage,{id:"developerIntegrationLab.title.label",defaultMessage:"Link Preview Lab"}),subtitle:o()(_.FormattedMessage,{id:"developerIntegrationLab.subtitle.label",defaultMessage:"Plan out preview URL regex patterns and API responses."}),onNavigateBack:()=>(0,x.V2)(t,r),navigateBackMessage:o()(_.FormattedMessage,{id:"developerIntegrationLab.navigateBack.label",defaultMessage:"Back to integration"}),innerContainerStyles:{width:1200,margin:"auto",marginBottom:200}},void 0,o()(z,{starterIntegration:n.value}))}function z(e){let{starterIntegration:t}=e;const[r,a]=s().useState(""),[i,n]=s().useState(I.Az),[l,d]=s().useState(I.SV),[u,c]=s().useState(I.VR()),[p,g]=s().useState(I.nZ),[m,v]=s().useState(I.e_),[f,y]=s().useState(I.P4),[b,_]=s().useState(t);return s().useEffect((()=>{const{original_url_domains:e,development_url_domains:r,original_url_patterns:a}=t.info,i=(null==e?void 0:e[0])||(null==r?void 0:r[0]);if(i&&g(i),null!=a&&a[0]){const{regex:e,attributes:t}=null==a?void 0:a[0];v(e);const r=t.map(h.Ah);y(r)}}),[t]),s().useEffect((()=>{_((e=>I.Hx({domain:p,regex:m,attributes:f,currentIntegration:e})))}),[p,m,f]),s().useEffect((()=>{S.Z.setState({loaded:!0,loading:!1,spaceId:I.C,integrations:[b],externalAuthentications:[],bots:[]})}),[b]),o()("div",{style:{display:"flex",justifyContent:"space-between"}},void 0,o()(G,{style:{flex:1,marginRight:12},setErrorMessage:a,rootUrl:i,setRootUrl:n,relatedUrisToAttributes:u,setRelatedUrisToAttributes:c,domain:p,setDomain:g,regexPattern:m,setRegexPattern:v,regexAttributes:f,setRegexAttributes:y,rootAttributes:l,setRootAttributes:d}),o()(K,{style:{flex:1},rootUrl:i,rootAttributes:l,relatedUrisToAttributes:u,integration:b,errorMessage:r}))}function G(e){const{style:t,rootUrl:r,setRootUrl:a,domain:i,setDomain:n,regexPattern:l,setRegexPattern:s,regexAttributes:d,setRegexAttributes:c,rootAttributes:p,setRootAttributes:g,relatedUrisToAttributes:v,setRelatedUrisToAttributes:f,setErrorMessage:h}=e,b=(0,u.VK)((()=>I.TG(p)),[p]);return o()("div",{style:t},void 0,o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:y.Z.fontWeight.medium}},void 0,o()(_.FormattedMessage,{id:"developerIntegrationLab.rootUrl.label",defaultMessage:"Pasted URL to Preview",description:"A url that the developers can test their integrations against as if a user attempted to unfurl it themselves."})),o()(A.Z,{value:r,onChange:e=>a(e.target.value)})),o()(j,{title:o()(_.FormattedMessage,{id:"developerIntegrationLab.regexConfiguration.label",defaultMessage:"Manage Regex Configuration",description:"Allows developers to test out regular expressions to match pasted unfurled urls."}),style:{marginTop:12}},void 0,o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:y.Z.fontWeight.medium}},void 0,o()(_.FormattedMessage,{id:"developerIntegrationLab.domain.label",defaultMessage:"Domain",description:"The domain of their integration (e.g. 'notion.so')."})),o()(A.Z,{value:i,onChange:e=>n(e.target.value)})),o()(X,{regexPattern:l,setRegexPattern:s,setErrorMessage:h}),o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:y.Z.fontWeight.medium}},void 0,o()(_.FormattedMessage,{id:"developerIntegrationLab.regexAttributes.label",defaultMessage:"Regex Attributes",description:"The matched attributes within their configuredregex patterns."})),o()(Y,{value:d,onChange:c,validationType:m.$1,setErrorMessage:h}))),o()(j,{title:o()(_.FormattedMessage,{id:"developerIntegrationLab.rootAttributes.label",defaultMessage:"Unfurl response payload",description:"Allows developers to test their unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,o()(Y,{value:p,onChange:g,validationType:m.$1,setErrorMessage:h})),o()(j,{title:o()(_.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.label",defaultMessage:"Related unfurl response payloads",description:"Allows developers to test additional unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,b.map((e=>{const t=v[e];return o()(j,{title:e,style:{marginTop:12,marginLeft:12}},void 0,t?o()(Y,{value:t,onChange:t=>{f({...v,[e]:t})},validationType:m.$1,setErrorMessage:h}):o()(_.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.empty",defaultMessage:"No related attributes found."}))}))))}const W=["preview","mention","hover"],H=["authenticate","error","update","loaded"];function K(e){const{style:t,rootUrl:r,rootAttributes:a,relatedUrisToAttributes:i,integration:n,errorMessage:l}=e,[d,u]=s().useState("preview"),[c,p]=s().useState("loaded");return o()("div",{style:t},void 0,o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()("div",{style:{marginRight:12}},void 0,"Preview type:"),o()(J,{title:d,options:W,onSelectOption:e=>u(e)}),o()("div",{style:{marginLeft:12,marginRight:12}},void 0,"Preview state:"),o()(J,{title:c,options:H,onSelectOption:e=>p(e)})),o()("div",{style:{marginTop:12,maxWidth:600}},void 0,o()($,{previewType:d,previewState:c,rootUrl:r,rootAttributes:a,relatedUrisToAttributes:i,integration:n,errorMessage:l})))}function j(e){const[t,r]=s().useState(!1);return o()("div",{style:e.style},void 0,o()(Z.Z,{onClick:()=>r(!t),style:{display:"flex",alignItems:"center"}},void 0,g.Z.triangle({width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:"rotateZ(".concat(t?180:90,"deg)"),marginRight:4}),e.title),t&&e.children)}function Y(e){const{value:t,onChange:r,validationType:a,setErrorMessage:i}=e,[n,l]=s().useState(JSON.stringify(t,null,2));return o()(A.Z,{format:A.B.ExtraLarge,inputStyle:{fontSize:14,lineHeight:"18px",height:500},textarea:!0,value:n,onChange:e=>{const t=e.target.value;l(t);const n=F.Jv(t);if(void 0===n)i("Could not parse JSON object input.");else{const e=(0,b.Gu)(a,n);e?i(e.message):(i(""),r(n))}}})}function X(e){const{regexPattern:t,setRegexPattern:r,setErrorMessage:a}=e,[i,n]=s().useState(t);return o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:y.Z.fontWeight.medium}},void 0,"Regex Pattern"),o()(A.Z,{value:i,onChange:e=>{const t=e.target.value;n(t);try{new RegExp(t);r(t),a("")}catch(i){a("Invalid Regex.")}}}))}function J(e){const{title:t,options:r,onSelectOption:a}=e,[n,l,d]=(0,u.oR)(void 0,k.Z);return o()(C.Z,{popupType:C.Z.PopupType.Popup,buttonPopupStore:d,renderOrigin:()=>o()(q.Z,{onClick:()=>l({...n,open:!0})},void 0,t,g.Z.chevronDown({width:10,marginTop:4,marginLeft:4})),render:()=>o()(U.ZP,{menuType:U.ZP.MenuType.Popup},void 0,o()(D.Z,{type:D.Z.Type.Vertical,sections:[{key:t,items:r.map((e=>({key:e,action:()=>{a(e),l({...n,open:!1})},render:t=>s().createElement(T.Z,i()({},t,{title:e}))}))),render:e=>s().createElement(N.Z,e)}],initialFocus:void 0}))})}function $(e){const{previewType:t,previewState:r,rootUrl:a,rootAttributes:i,relatedUrisToAttributes:n,integration:l,errorMessage:u}=e,[p,g]=s().useState(""),m=(0,d.O7)(),[v,f]=s().useState();s().useEffect((()=>{const e=I.rn({environment:m,rootUrl:a,rootAttributes:i,relatedUrisToAttributes:n,integration:l});"error"in e?g(e.error):(g(""),f(e))}),[m,a,i,n,l]),s().useEffect((()=>{g(u)}),[u]);const y=(0,c.y)((e=>({error:{marginTop:12,marginBottom:12,padding:"12px 24px",marginRight:"auto",backgroundColor:e.accentColors.red[100]}})),[]);return s().createElement(s().Fragment,null,p&&o()("div",{style:y.error},void 0,p," "),v&&o()(ee,{previewType:t,previewState:r,previewStores:v}))}function Q(e){const{previewStores:t}=e,r=(0,c.y)((e=>({container:{borderRadius:4,boxShadow:e.lightBoxShadow}})),[]),a=(0,u.VK)((()=>{const e=t.previewBlockStore.getValue();if(null==e||!e.id)return;return{annotation:(0,v.x3)(e.id),store:t.inlineBlockStore,token:void 0}}),[t.previewBlockStore,t.inlineBlockStore]);return a?o()("div",{style:r.container},void 0,o()(V.D,{isHoveredTokenEditable:!0,state:a})):null}function ee(e){const{previewType:t,previewState:r,previewStores:a}=e;return"preview"===t?o()(B.Z,{store:"authenticate"===r?a.emptyInstanceBlockStore:a.previewBlockStore,disabled:!1,forceActionForUIDoc:"loaded"===r?void 0:r}):"mention"===t?o()(L.Z,{store:"authenticate"===r?a.emptyInlineBlockStore:a.inlineBlockStore,disabled:!1}):"hover"===t?s().createElement(Q,e):void(0,f.t1)(t)}},29823:(e,t,r)=>{r.d(t,{Z:()=>c});var a=r(77094),i=r.n(a),n=(r(67294),r(480)),o=r(3779),l=r(5366),s=r(45016),d=r(43250),u=r(97812);function c(){const e=(0,n.O7)();return i()(u.Z,{className:d.wG,title:i()(l.FormattedMessage,{id:"developerIntegrationNotFound.title.label",defaultMessage:"Not Found"}),subtitle:i()(l.FormattedMessage,{id:"developerIntegrationNotFound.subtitle.label",defaultMessage:"This integration doesnâ€™t exist."}),onNavigateBack:()=>(0,s.A1)(e),icon:o.Z.eyes({width:98,height:98}),sideContent:null},void 0,null)}},59781:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var a=r(77094),i=r.n(a),n=(r(33948),r(67294)),o=r(480),l=r(28350),s=r(63123),d=r(59054),u=r(39248),c=r(77420),p=r(44312),g=r(49953),m=r(9844),v=r(70043),f=r(97880),y=r(5366),h=r(50906),b=r(61269),_=r(45016),x=r(43250),M=r(27832),F=r(85227),I=r(3403),w=r(20088),k=r(29823),S=r(97812),R=r(73678),Z=r(56200),T=r(42402),C=r(40039);function P(e){const{botOrIntegrationPointer:t}=e,r=(0,o.O7)(),[{currentUserStore:a}]=(0,l.oR)(M.default),[,,P]=(0,l.oR)(void 0,F.Z),E=(0,l.Kw)(P),B=(0,l.VK)((()=>{if(t&&a){const e=t.table,r=a.getRecordValue(t);if(r){const i=e===m.K2&&"external"===r.type&&a.getRecordValue({table:g.r9,id:t.id});return{botOrIntegrationRecord:{value:r,table:t.table},maybeExternalAuthRecord:i?{table:g.r9,value:i}:void 0}}}}),[a,t]),[{value:V}]=(0,d.r5)((async()=>{if(!a||!B||B.botOrIntegrationRecord.table!==m.K2)return[];const e=B.botOrIntegrationRecord.value.id,t=await b.getIntegrationDomainVerifications(r,{integrationId:e});if("success"===t.type){return t.data.verificationIds.map((e=>a.getRecordValue({table:p.Jd,id:e}))).filter(f.$K)}if("failed"===t.type)throw t.error;return(0,f.t1)(t)}),[r,B,a]);(0,n.useEffect)((()=>{if(!B)return;const{botOrIntegrationRecord:e,maybeExternalAuthRecord:t}=B;P.initializeNewForm(e,t,V||[]),h.DUp(r,{table:e.table})}),[P,r,B,V]);const A=(0,s.V)({value:E.startingRecord});if("rejected"===A.status||!t)return i()(k.Z,{});if("pending"===A.status)return i()(I.Z,{});"resolved"!==A.status&&(0,f.t1)(A);const U=A.value,D=U.value.name,q=U.table===c.cZ?U.value.icon:U.value.info.icon,N={id:U.value.id,table:U.table},L=q?{pointer:N,icon:q}:void 0;return i()(S.Z,{className:x.TF,title:D,subtitle:i()(y.FormattedMessage,{id:"developerIntegrationView.subtitle.label",defaultMessage:"Review and edit integration information."}),onNavigateBack:()=>(0,_.A1)(r),icon:i()(C.Z,{disabled:!0,icon:L,title:D,isEmptyPage:!1,size:98,isLarge:!0,style:{boxShadow:v.Z.frontDeepShadow},useInvertedColors:!0}),sideContent:i()(Z.T,{integrationFormStore:P})},void 0,"published"===E.status&&i()(w.Z,{type:w.$.Red,isMobile:!1},void 0,i()(y.FormattedMessage,{id:"developerIntegrationView.publishedIntegrationWarning",defaultMessage:"As soon as you save changes to this page, your listing on Notion'sÂ <integrationgallerylink>Integration Gallery</integrationgallerylink>Â will be updated.",description:"A warning that appears to developers when they're editing an integration that has already been published in our Integration Gallery.",values:{integrationgallerylink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i()(T.Z,{disableHover:!0,href:(0,u.E)(U.value.id,U.value.name||"")},void 0,t)}}})),i()(R.Z,{integrationFormStore:P}))}},8871:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var a=r(77094),i=r.n(a),n=(r(33948),r(67294),r(28350)),o=r(5366),l=r(43250),s=r(85227),d=r(97812),u=r(73678),c=r(56200);function p(e){const{onClose:t,onSuccess:r}=e,[,,a]=(0,n.oR)(void 0,s.Z);return i()(d.Z,{className:l.Zp,title:i()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.title.label",defaultMessage:"Create a new integration"}),subtitle:i()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.subtitle.label",defaultMessage:"Weâ€™ll walk you through how to setup a new integration."}),onNavigateBack:t,sideContent:i()(c.T,{integrationFormStore:a})},void 0,i()(u.Z,{onCreateNew:r,integrationFormStore:a,shouldAutoFocusFirstField:!0}))}},73678:(e,t,r)=>{r.d(t,{Z:()=>Ve});var a=r(97464),i=r.n(a),n=r(77094),o=r.n(n),l=(r(33948),r(96486)),s=r(67294),d=r.n(s),u=r(13991),c=r(480),p=r(28350),g=r(8848),m=r(84619),v=r(3779),f=r(74446),y=r(45953),h=r(89101),b=r(77420),_=r(44312),x=r(9844),M=r(75246),F=r(97880),I=r(82990),w=r(5366),k=r(50906),S=r(61269),R=r(66055),Z=r(45016),T=r(47307),C=r(43250),P=r(81710),E=r(65270),B=r(33665),V=r(38755),A=r(27832),U=r(52507),D=r(90031),q=r(64442),N=r(14947),L=r(48762),O=r(82970),z=r(24405),G=r(71202),W=r(25584),H=r(66722),K=r(83071);function j(e){const{value:t}=e,[r,a]=d().useState(!1),n=()=>a(!1);return o()(H.GI,{popupType:H.GI.PopupType.Popup,alignmentToOrigin:H.GI.Alignment.Start,placementToOrigin:H.GI.Placement.Bottom,originGap:2,sameWidthAsOrigin:!0,open:r,onDismiss:n,render:()=>d().createElement(X,i()({},e,{value:t,onClose:n})),origin:d().createElement(Y,i()({},e,{value:t,onClick:()=>a(!0)}))})}function Y(e){const{onClick:t,value:r,renderMenuItem:a}=e,i=(0,z.y)((e=>({dropdown:{background:e.whiteButtonBackground,border:"1px solid ".concat(e.outlineButtonBorder),borderRadius:3,height:32},expandIcon:{height:12,width:12,fill:e.lightIconColor}})),[]);return d().createElement(d().Fragment,null,a({item:r,focused:!1,onClick:t,style:i.dropdown,right:v.Z.expand(i.expandIcon)}))}function X(e){const{keyName:t,items:r,value:a,setValue:i,renderMenuItem:n,onClose:l}=e;let s=0;const u=r.map(((e,t)=>(e.id===(null==a?void 0:a.id)&&(s=t),{key:e.id,action:()=>{i(e),l()},render:t=>n({...t,item:e})})));return o()(G.ZP,{menuType:G.ZP.MenuType.Popup},void 0,o()(W.Z,{type:W.Z.Type.Vertical,initialFocus:s,sections:[{key:"form-input-section-".concat(t),items:u,render:e=>d().createElement(K.Z,e)}]}))}var J=r(38381),$=r(98481),Q=r(42402);function ee(e){const{onSubmit:t,children:r,submitType:a,capabilitiesHaveChanged:i}=e,n="create-bot"===a||"create-guest-integration"===a||"create-third-party-external-integration"===a;return o()("form",{id:"developer-integration-form",style:{minWidth:200,maxWidth:440,marginLeft:24,display:"flex",flexDirection:"column"},onSubmit:e=>{e.preventDefault(),"create-guest-integration"===a?J.Z.setState({open:!0,isDestructive:!1,isWarning:!1,title:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.title",defaultMessage:"Switch to Public integration?"}),message:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.message",defaultMessage:"Youâ€˜ll get an OAuth secret and will need to implement OAuth for authorization. See <oauthdocumentationlink>developer docs</oauthdocumentationlink> for more information.",values:{oauthdocumentationlink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o()(Q.Z,{href:h._j.developerOAuthDocs},void 0,t)}}}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.confirm",defaultMessage:"Continue"}),onConfirm:()=>{t()}}):"update-guest-integration"===a&&i?J.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.title",defaultMessage:"Change requested capabilities?"}),message:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.message",defaultMessage:"Any existing users of your integration will be required to re-authenticate."}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.confirm",defaultMessage:"Change"}),onConfirm:()=>{t()}}):t()}},void 0,r,o()("div",{style:{display:"flex",marginTop:24,flexDirection:"row-reverse",alignItems:"center"}},void 0,o()($.h,{onClick:()=>{const e=document.querySelector("form#developer-integration-form");if(e){const t=e.ownerDocument.createElement("input");t.style.display="none",t.type="submit",e.appendChild(t).click(),e.removeChild(t)}}},void 0,o()(te,{isCreate:n})),n&&o()("span",{style:{fontSize:15,color:g.ZP.frontTextLight,marginRight:42}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.create.developerTerms",defaultMessage:"By submitting, you agree to Notion's <developertermslink>Developer Terms</developertermslink>.",values:{developertermslink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o()(Q.Z,{href:h._j.developerTerms},void 0,t)}}}))))}function te(e){const{isCreate:t}=e;return t?d().createElement(d().Fragment,null,o()("div",{style:{marginRight:4}},void 0,o()(w.FormattedMessage,{id:"formHandler.submitButton.create.label",defaultMessage:"Submit"})),v.Z.arrowRight({width:14,height:14})):o()(w.FormattedMessage,{id:"formHandler.submitButton.create.update",defaultMessage:"Save changes"})}var re=r(53471),ae=r(4637),ie=r(68932),ne=r(47966),oe=r(48243);function le(e){const{value:t,setValue:r,setError:a}=e,i=(0,c.O7)(),[n,l]=d().useState(!1);return d().createElement(d().Fragment,null,t&&o()(oe.Z,{url:t,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>o()("div",{style:{width:90,height:90}},void 0,o()(ae.Z,{src:t,style:{width:90,height:90,objectFit:"cover",borderRadius:3}}))}),o()(ne.Z,{isLarge:!0,style:{width:"fit-content",backgroundColor:"white"},onClick:()=>{(0,re.cR)({environment:i,onStart:()=>l(!0),bucket:"public",onError:e=>{a(e.message),l(!1)},onComplete:e=>{r(e[0]),l(!1)},accept:"image/*"})}},void 0,o()(w.FormattedMessage,{id:"formInputIcon.uploadButton.label",defaultMessage:"Upload image"}),n&&o()(ie.Z,{style:{marginLeft:4}})))}function se(e){const{label:t,subtitle:r,caption:a,error:i,children:n}=e,l=(0,z.y)((()=>({label:{fontSize:15,fontWeight:I.Z.fontWeight.medium,color:g.ZP.frontTextMedium},subtitle:{fontSize:15,color:g.ZP.frontTextLight},caption:{fontSize:15,color:g.ZP.frontTextLight},error:{marginTop:4,fontSize:15,color:g.ZP.frontRed},field:{display:"grid",gridTemplateColumns:"1fr",gap:6,marginBottom:32}})),[]);return o()("label",{style:l.field},void 0,o()("div",{style:l.label},void 0,t),a&&o()("div",{style:l.caption},void 0,a),n,r&&o()("div",{style:l.subtitle},void 0,r),i&&o()("div",{style:l.error},void 0,i))}var de=r(14598),ue=r(46951);function ce(e){const{options:t,value:r,setValue:a}=e;return o()("div",{style:{display:"flex",flexDirection:"column"}},void 0,t.map(((e,i)=>o()(pe,{option:e,value:r,setValue:a,isFirst:0===i,isLast:i===t.length-1},e.key))))}function pe(e){const{option:t,value:r,setValue:a,isFirst:i,isLast:n}=e,l=(0,z.y)((e=>({outliner:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto",padding:18,whiteSpace:"normal",fontSize:15,background:e.whiteButtonBackground,borderTopLeftRadius:i?3:0,borderTopRightRadius:i?3:0,borderBottomLeftRadius:n?3:0,borderBottomRightRadius:n?3:0,...!i&&{borderTop:void 0}}})),[i,n]);return o()(ne.Z,{onClick:()=>a(t.key),style:l.outliner},void 0,o()(de.Z,{title:t.title,isSelected:r===t.key,onClick:()=>{}},t.key),o()(ue.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginLeft:24,marginTop:-4,fontSize:15}},void 0,t.caption))}var ge=r(91996),me=(r(73210),r(74181)),ve=r(95477),fe=r(85567),ye=r(719);function he(e){const{currentValue:t,setNewValue:r,typeaheadTitle:a}=e,n=t||[],[l,s]=d().useState(""),u=()=>s("");return o()(H.ZP,{popupType:H.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:l.length>0,onDismiss:u,origin:o()(ye.Z,{style:{background:g.ZP.white,minHeight:32,fontSize:15},placeholder:"",value:l,onChange:e=>s(e.target.value),tokens:n.map(((e,t)=>o()(fe.Z,{format:m.l.Medium,showRemoveButton:!0,isSingle:!1,shouldWrap:!0,value:e,onClickRemove:()=>{r(n.filter((t=>t!==e)))}},"".concat(e,"-").concat(t)))),onRemoveLastToken:()=>{n.length>0&&r(n.slice(0,n.length-1))}}),render:()=>{const e=l.trim(),t=(0,me.ue)(ve.default.domainBaseUrl,e).map((e=>({key:e,render:t=>d().createElement(L.Z,i()({},t,{title:e})),action:()=>{u(),r([...n,e])}})));return o()(G.ZP,{menuType:G.ZP.MenuType.Popup},void 0,o()(W.Z,{type:W.Z.Type.Vertical,initialFocus:0,sections:[{key:"valid-url-suggestion",items:t,render:e=>d().createElement(K.Z,i()({},e,{title:a}))}]}))}})}var be=r(62727);function _e(e){const{currentRule:t,onUpdate:r,shouldShowDelete:a,onDelete:i,onError:n}=e,{name:l,regex:s,attributes:u,sampleUrls:c}=t,[p,m]=d().useState(JSON.stringify(u,null,2));return o()("div",{style:{marginBottom:24}},void 0,o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:g.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.regexRule.name.label",defaultMessage:"Rule Name",description:"Label for the name input of the developer's pattern rule (e.g. github_pull)"})),o()(be.Z,{inputClassName:l,style:{background:g.ZP.white,height:32,fontSize:15},value:l,onChange:e=>{r({...t,name:e.target.value})},right:a&&o()(xe,{onDelete:i})})),o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:g.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.sampleUrls.label",defaultMessage:"Sample URLs",description:"Label name for a field for sample URLs the developer wants to test their regexes on."})),o()(he,{currentValue:c,setNewValue:e=>{r({...t,sampleUrls:e})},setErrorValue:e=>n(e),typeaheadTitle:o()(w.FormattedMessage,{id:"developerIntegrationsForm.urlsInput.typePrompt",defaultMessage:"Type or paste a urlâ€¦",description:"Prompt that appears as user adds urls to an input field."})})),o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:g.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.regexRule.pattern.label",defaultMessage:"Pattern",description:"Label for the regex input of the developer's regex pattern rule."})),o()(be.Z,{style:{background:g.ZP.white,fontSize:15,borderRadius:"3px 3px 0px 0px"},autosize:!0,textarea:!0,value:s,onChange:e=>{r({...t,regex:e.target.value})}})),o()(be.Z,{format:be.B.ExtraLarge,style:{borderRadius:"0px 0px 3px 3px",boxShadow:void 0,backgroundColor:g.ZP.white,border:"1px solid ".concat(g.ZP.uiExtraLightGray),borderTop:0,padding:0},inputStyle:{fontSize:14,lineHeight:"18px",height:200,fontFamily:I.Z.baseFontFamily.mono,padding:4},textarea:!0,value:p,onChange:e=>{const a=e.target.value;m(a);const i=(0,ge.Jv)(a);void 0===i?n(o()(w.FormattedMessage,{id:"developerIntegrationForm.jsonEditor.error",defaultMessage:"{value} attributes has invalid JSON.",description:"Error message returned to a developer when their payload is invalid.",values:{value:l}})):r({...t,attributes:i})}}))}function xe(e){let{onDelete:t}=e;return o()(N.Z,{style:{padding:4,borderRadius:3},onClick:()=>{J.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:o()(w.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.title",defaultMessage:"Are you sure you want to delete this regex pattern rule?",description:"Confirmation modal message developer receives when trying to delete a Link Preview regex pattern rule."}),message:o()(w.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.message",defaultMessage:"Changes will not be saved until you submit the form.",description:"Help message show in confirmation modal when developer tries to delete a Link Preview regex pattern rule."}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.confirm",defaultMessage:"Delete",description:"Confirmation message shown in modal when developer tries to delete a Link Preview regex pattern rule."}),onConfirm:()=>{t()}})}},void 0,v.Z.trash({width:15,height:15}))}var Me=r(40039),Fe=r(79029);const Ie=d().forwardRef(((e,t)=>{const{item:r,...a}=e,n=(0,c.O7)(),l=(0,p.VK)((()=>r&&(0,V.getSpaceIcon)(n,r)),[n,r]),s=(0,p.VK)((()=>r&&(0,V.getSpaceName)(n,r)),[n,r]);return d().createElement(L.Z,i()({},a,{ref:t,title:r&&o()(Fe.Z,{store:r}),icon:r&&o()(Me.Z,{disabled:!0,icon:l,title:s,isEmptyPage:!1,size:19})}))}));var we=r(56200),ke=r(37235);function Se(e){const{fetchSecret:t,secretName:r,onCopy:a,onError:i,confirmationModalProps:n,hasSecretBeenViewed:l}=e,s=(0,c.O7)(),[p,m]=d().useState();return o()(be.Z,{type:p?"text":"password",disabled:!0,style:{fontFamily:I.Z.getCompositeFontFamily(u.SP).mono,color:g.ZP.frontTextMedium},inputStyle:p?{cursor:"text"}:void 0,value:p||" ".repeat(40),right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),p?o()(Ze,{secretName:r,onClick:()=>{a&&a(),(0,R.RD)({environment:s,stringValue:p,copiedMessage:R.tq.copiedToClipboard})}}):o()(Re,{hasSecretBeenViewed:l,onClick:async()=>{const e=async()=>{const e=await t();"secret"in e?m(e.secret):i(e.error.body.message)};n?J.Z.setState({...n,open:!0,onConfirm:e}):await e()}}))})}function Re(e){const{onClick:t,hasSecretBeenViewed:r}=e;return o()(N.Z,{onClick:t,style:Te.button},void 0,o()(w.FormattedMessage,r?{id:"formSecretShow.refreshSecret.label",defaultMessage:"Refresh"}:{id:"formSecretShow.showSecret.label",defaultMessage:"Show"}))}function Ze(e){const{onClick:t,secretName:r}=e,[a,n]=d().useState(!1),l=o()(w.FormattedMessage,a?{defaultMessage:"{secretName} copied",id:"formSecretShow.secretCopied.tooltip",description:"Tooltip shown when user copied integration secret to clipboard",values:{secretName:r}}:{defaultMessage:"Copy {secretName}",id:"formSecretShow.copySecret.tooltip",description:"Shortcut for copying a token from an integration management page; 'secretName' will be either 'secret' or 'token'",values:{secretName:r}});return o()(ke.Z,{placement:ke.Z.Placement.Top,renderTooltip:()=>l,render:e=>d().createElement(N.Z,i()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),t()}},e,{style:{...Te.button,color:a?g.ZP.mediumTextColor:g.ZP.blue}}),o()(w.FormattedMessage,a?{id:"formSecretShow.copied.label",defaultMessage:"Copied"}:{id:"formSecretShow.copySecret.label",defaultMessage:"Copy"}))})}const Te={button:{display:"inline-flex",alignItems:"center",fontFamily:I.Z.getCompositeFontFamily(u.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:g.ZP.blue}};var Ce=r(51490),Pe=r(42001),Ee=r(83328),Be=r(5478);function Ve(e){var t;const{integrationFormStore:r,onCreateNew:a,shouldAutoFocusFirstField:i}=e,n=(0,w.useIntl)(),u=(0,c.O7)(),[{currentUserRootStore:g}]=(0,p.oR)(A.default),m=(0,p.Kw)(r),{type:v}=m,f=(0,p.VK)((()=>(0,P.fY)()),[]),y=(0,p.VK)((()=>(0,P.Le)(r.getState().startingRecord)),[r]),[h,b]=d().useReducer(P.x6,P.yb);(0,s.useEffect)((()=>{if(!g)return;const e=(0,P.hl)({formStoreState:m,userRootStore:g});for(const t of(0,F.Yd)(e))b({field:t,value:e[t]})}),[m,g]);const _=(0,p.VK)((()=>g?g.getAdminSpaceStores():[]),[g]),x=l.debounce((()=>{const e=(0,P.Xk)({formData:h,formStateType:v});e.forEach((e=>{b({field:e,error:o()(w.FormattedMessage,{id:"developerIntegrationsForm.error.missingRequired",defaultMessage:"{ fieldName } is required.",values:{fieldName:f[e].label}})})}));const t=(0,P.bd)({formData:h,formStateType:v});t.forEach((e=>{b({field:e.fieldName,error:e.errorMessages?e.errorMessages.map(((e,t)=>{let{descriptor:r,values:a}=e;return o()("div",{},"validation-error-".concat(t),n.formatMessage(r,a))})):o()(w.FormattedMessage,{id:"developerIntegrationsCreateInternal.error.invalidInput",defaultMessage:"{ fieldName } is invalid.",values:{fieldName:f[e.fieldName].label}})})}));if(e.length>0||t.length>0||(0,P.tm)({formData:h,formStateType:v})||!g)return;const r=(0,Z.JJ)({environment:u,formState:m,formData:(0,P.Xr)(h)});if(!r)return void T.showErrorMessage(o()(w.FormattedMessage,{id:"developerIntegrationsForm.error.submission",defaultMessage:"There was an error submitting your integration. Please try again or contact support if the issue persists."}));a&&a(r);const i=document.querySelector(".".concat(C.rI));i&&i.scrollIntoView({behavior:"smooth"})}),300),M=function(e,t){if(e&&t)for(const[r,a]of(0,F.qP)(t))if(Boolean(e[r])!==a)return!0;return!1}(null===(t=m.startingRecord)||void 0===t?void 0:t.value.capabilities,h.capabilities.value);return o()(ee,{submitType:v,onSubmit:x,capabilitiesHaveChanged:M},void 0,P.cW.map((e=>y[e].supportedBy[v]?o()("div",{style:{marginBottom:24}},e,o()(we.e,{keyName:e,integrationFormStore:r}),y[e].fields.map((e=>{const{supportedBy:t,label:a,subtitle:n,caption:l}=f[e];if(t[v]){const t=Ae[e];return o()(se,{label:a,subtitle:n,caption:l,error:h[e].error},e,o()(t,{autoFocus:Boolean(i&&"name"===e),spaces:_,currentValue:h[e].value,setErrorValue:t=>{b({field:e,error:t})},setNewValue:t=>{"submission_type"!==e?"client_secret"!==e&&"token"!==e&&b({value:t,field:e}):r.updateRecordTypeOnSubmission(t)},formStoreState:m}))}return null}))):null)))}const Ae={token:function(e){const{currentValue:t,setErrorValue:r}=e,[{currentUserStore:a}]=(0,p.oR)(A.default),i=(0,c.O7)(),n=(0,p.VK)((()=>{if(!a||!t)return;if(t.value.parent_table!==M.bx)return;const e=q.Z.createChildStore(a,{id:t.value.parent_id,table:t.value.parent_table});return(0,V.getSpaceName)(i,e)}),[a,t,i]);if(!t)return null;return d().createElement(d().Fragment,null,o()(Se,{fetchSecret:async()=>{const e=await S.getBotToken(i,{botId:t.value.id});return"success"===e.type?(k.Cm3(i,{table:t.table}),{secret:e.data.token}):{error:e}},secretName:o()(w.FormattedMessage,{id:"developerIntegrationForm.botToken.secretName",defaultMessage:"token"}),onCopy:()=>{k.IVn(i,{table:t.table,from:"developer-integrations-view"})},onError:r}),n&&o()("div",{style:{fontSize:15,color:g.ZP.frontTextLight}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.botToken.subtitle",defaultMessage:"Only works with the <bold>{spaceName}</bold> workspace. To change workspace, <developertermslink>create another integration</developertermslink>.",values:{spaceName:n,bold:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o()("b",{},void 0,t)},developertermslink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o()(Q.Z,{href:h._j.myIntegrations},void 0,t)}}})))},client_id:function(e){const{currentValue:t}=e,r=(0,c.O7)(),[a,n]=d().useState(!1);if(!t)return null;const l=o()(w.FormattedMessage,a?{defaultMessage:"ID copied",id:"developerIntegrationsForm.clientIdCopied.tooltip"}:{defaultMessage:"Copy client ID",id:"developerIntegrationsForm.copyClientId.tooltip"});return o()(be.Z,{type:"text",disabled:!0,style:{color:g.ZP.frontTextMedium,fontFamily:I.Z.getCompositeFontFamily(u.SP).mono},value:t.value.id,right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),o()(ke.Z,{placement:ke.Z.Placement.Top,renderTooltip:()=>l,render:e=>d().createElement(N.Z,i()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),(0,R.RD)({environment:r,stringValue:t.value.id,copiedMessage:R.tq.copiedLinkToClipboard})}},e,{style:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:a?g.ZP.frontTextMedium:g.ZP.blue,fontFamily:I.Z.getCompositeFontFamily(u.SP).sans}}),o()(w.FormattedMessage,a?{id:"developerIntegrationsForm.copiedId.label",defaultMessage:"Copied"}:{id:"developerIntegrationsForm.copyId.label",defaultMessage:"Copy"}))}))})},client_secret:function(e){const{currentValue:t,setErrorValue:r}=e,a=(0,c.O7)(),[{currentUserStore:i}]=(0,p.oR)(A.default);if(!t||!i)return null;const n=t.value.info.has_viewed_secret,l=(0,D.Kv)(i,{id:t.value.id,table:x.K2});return o()(Se,{fetchSecret:async()=>{const e=await S.getIntegrationSecret(a,{integrationId:t.value.id});return"success"===e.type?((0,Z.bO)({environment:a,integrationStore:l}),k.Cm3(a,{table:t.table}),{secret:e.data.secret}):{error:e}},secretName:o()(w.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.secretName",defaultMessage:"secret"}),onCopy:()=>{k.IVn(a,{table:t.table,from:"developer-integrations-view"})},onError:r,hasSecretBeenViewed:n,confirmationModalProps:{isDestructive:!1,isWarning:!1,title:o()(w.FormattedMessage,n?{id:"developerIntegrationForm.clientSecret.confirmationModal.title",defaultMessage:"Refresh OAuth client secret?"}:{id:"developerIntegrationForm.clientSecret.confirmationModal.title",defaultMessage:"Show OAuth client secret?"}),message:o()(w.FormattedMessage,n?{id:"developerIntegrationForm.clientSecret.confirmationModal.message",defaultMessage:"Youâ€™ve already viewed the client secret. Viewing again will revoke and generate a new one. Make sure youâ€™re storing the secret securely."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.message",defaultMessage:"This client secret will only be displayed once and cannot be viewed again. Make sure youâ€™re storing the secret securely."}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationForm.clientSecret.confirmationModal.confirm",defaultMessage:"Continue"})}})},name:Ue,icon:function(e){const{currentValue:t,setNewValue:r,setErrorValue:a}=e;return o()(le,{value:t,setValue:r,setError:a})},space:qe,developer_space:qe,submission_type:function(e){const{currentValue:t,setNewValue:r,formStoreState:a}=e,i=(0,c.O7)(),n={internal:{title:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.title",defaultMessage:"Internal integration"}),caption:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.caption",defaultMessage:"Only available for workspaces youâ€™re an admin of. The integration can be installed to those workspaces automatically and does not require review."})},public:{title:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.public.title",defaultMessage:"Public integration"}),caption:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.public.caption",defaultMessage:"Available for any Notion user. May require review and verification for listing in the Integration Gallery."})},unfurling:{title:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.unfurling.title",defaultMessage:"Unfurling integration"}),caption:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.unfurling.caption",defaultMessage:"Available for any Notion user. May require review and verification for listing in the Integration Gallery."})}};if(!t)return null;let l;"update-bot"===a.type||"create-guest-integration"===a.type?l=[{...n.internal,key:"internal"},{...n.public,key:"public"}]:"create-bot"!==a.type&&"create-third-party-external-integration"!==a.type||(l=[{...n.internal,key:"internal"},{...n.unfurling,key:"unfurling"}]);if(!l)return null;return o()(ce,{options:l,value:t,setValue:e=>{r(e),k.kXt(i,{table:"internal"===e?b.cZ:x.K2})}})},redirect_uris:function(e){return d().createElement(he,i()({},e,{typeaheadTitle:o()(w.FormattedMessage,{id:"developerIntegrationsForm.redirectUri.typePrompt",defaultMessage:"Type a redirect uriâ€¦"})}))},website_url:Ue,tagline:Ue,privacy_policy_url:Ue,terms_of_use_url:Ue,email:Ue,capabilities:function(e){const{setNewValue:t}=e,r={...P.fP,...e.currentValue},{enableReadCommentsApi:a,enableWriteCommentsApi:n}=(0,P.qv)();let s;(a||n)&&(s={key:"comment_capabilities",items:[...a?[{key:"read_comment",action:()=>null,render:e=>{const a=()=>{t({...r,read_comment:!r.read_comment})};return d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_comment.title",defaultMessage:"Read comments",description:"Label for a check box to enable an integration to read comments."}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_comment.caption",defaultMessage:"Read comments on blocks and pages.",description:"Description for a check box to enable an integration to read comments."}),icon:o()(O.Z,{checked:Boolean(r.read_comment),size:16,onClick:a}),onClick:a}))}}]:[],...n?[{key:"insert_comment",action:()=>null,render:e=>{const a=()=>{t({...r,insert_comment:!r.insert_comment})};return d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_comment.title",defaultMessage:"Insert comments",description:"Label for a check box to enable an integration to insert comments."}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_comment.caption",defaultMessage:"Create comments on blocks and pages.",description:"Description for a check box to enable an integrations to insert comments."}),icon:o()(O.Z,{checked:Boolean(r.insert_comment),size:16,onClick:a}),onClick:a}))}}]:[]],render:e=>d().createElement(K.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.comment_capabilities.title",defaultMessage:"Comment Capabilities",description:"Header for a section where a developer can configure comment access for an integration."})}))});return o()(W.Z,{type:W.Z.Type.Vertical,initialFocus:void 0,sections:l.compact([{key:"content_capabilities",items:[{key:"read_content",action:()=>null,render:e=>{const a=()=>{t({...r,read_content:!r.read_content})};return d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_content.title",defaultMessage:"Read content"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_content.caption",defaultMessage:"Request to read content."}),icon:o()(O.Z,{checked:Boolean(r.read_content),size:16,onClick:a}),onClick:a}))}},{key:"update_content",action:()=>null,render:e=>{const a=()=>{t({...r,update_content:!r.update_content})};return d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.update_content.title",defaultMessage:"Update content"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.update_content.caption",defaultMessage:"Request to update existing content."}),icon:o()(O.Z,{checked:Boolean(r.update_content),size:16,onClick:a}),onClick:a}))}},{key:"insert_content",action:()=>null,render:e=>{const a=()=>{t({...r,insert_content:!r.insert_content})};return d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_content.title",defaultMessage:"Insert content"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_content.caption",defaultMessage:"Request to create new content."}),icon:o()(O.Z,{checked:Boolean(r.insert_content),size:16,onClick:a}),onClick:a}))}}],render:e=>d().createElement(K.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.content_capabilities.title",defaultMessage:"Content Capabilities"})}))},s,{key:"user_capabilities",items:[{key:"no_user_capabilities",action:()=>null,render:e=>d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.no_user_capabilities.title",defaultMessage:"No user information"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.no_user_capabilities.caption",defaultMessage:"Do not request any user information access."}),icon:o()(Ee.Z,{isSelected:!(r.read_user_without_email||r.read_user_with_email)}),onClick:()=>{t({...r,read_user_without_email:!1,read_user_with_email:!1})}}))},{key:"read_user_without_email",action:()=>null,render:e=>d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_without_email.title",defaultMessage:"Read user information without email addresses"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_without_email.caption",defaultMessage:"Request access to user information, not including email addresses."}),icon:o()(Ee.Z,{isSelected:r.read_user_without_email&&!r.read_user_with_email}),onClick:()=>{t({...r,read_user_without_email:!0,read_user_with_email:!1})}}))},{key:"read_user_with_email",action:()=>null,render:e=>d().createElement(L.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_with_email.title",defaultMessage:"Read user information including email addresses"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_with_email.caption",defaultMessage:"Request access to user information, including email addresses."}),icon:o()(Ee.Z,{isSelected:r.read_user_with_email}),onClick:()=>{t({...r,read_user_without_email:!0,read_user_with_email:!0})}}))}],render:e=>d().createElement(K.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.user_capabilities.title",defaultMessage:"User Capabilities"})}))}])})},developer_name:Ue,unfurl_url:Ue,domain:function(e){const{currentValue:t,autoFocus:r,setNewValue:a,formStoreState:i,setErrorValue:n}=e,l=(0,c.O7)(),s=(0,w.useIntl)();if("update-third-party-external-integration"!==i.type&&"update-first-party-external-integration"!==i.type)return null;const{developmentDomain:u,verifiedDomains:p,domainVerifications:v}=t||{developmentDomain:"",verifiedDomains:[],domainVerifications:[]},h=p.map((e=>({domain:e,status:Be.YF.Success,data:{type:"verified",domain:e}}))),b=Date.now(),x=v.filter(U.AS).sort(((e,t)=>e.createdAt-t.createdAt)).map((e=>({domain:e.domain,status:b>e.expiresAt?Be.YF.Failure:Be.YF.Pending,data:{...e,type:b>e.expiresAt?"invalid":"unverified"}}))),M=i.startingRecord.value.id,I=async()=>{const e=await S.getIntegrationDomainVerifications(l,{integrationId:M});if("success"===e.type){const t=y.Ak.create(e.data.recordMap),r=f.mF.fromRecordMapWithRole(t),i=e.data.verificationIds.map((e=>r({table:_.Jd,id:e}))).filter(F.$K).map(U.Hs).filter((e=>"verified"!==e.type));a({developmentDomain:u,verifiedDomains:p,domainVerifications:i})}},k=async e=>{if("verified"!==e.type){const t=await S.deleteDomainVerificationCode(l,{id:e.id});"failed"===t.type&&n(t.error.message),await I()}else(0,Z.QO)({environment:l,integrationId:M,allVerifiedDomains:p,domainToRemove:e.domain})};if("update-third-party-external-integration"===i.type)return o()(Ce.ZP,{domains:[...h,...x],domainVerificationStore:i.domainVerificationStore,verificationType:"integration",verificationTargetId:M,refreshDomains:I,onRemoveDomain:k});return d().createElement(d().Fragment,null,o()("div",{style:De},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.domain.developmentDomain.label",defaultMessage:"Development domain",description:"Label for the development domain input of the user's integration. The domain only used by the integration in the development workspace."})),o()(be.Z,{autoFocus:r,style:{background:g.ZP.white,height:32,fontSize:15},value:u,onChange:e=>a({verifiedDomains:p,domainVerifications:v,developmentDomain:e.target.value})}),o()("div",{style:De},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.domain.verifiedDomains.label",defaultMessage:"Verified domain(s)",description:"Label for domain verification input of the user's integration. Includes modals that will go through adding and verifying a domain and the list of verified domains."})),o()(ye.Z,{placeholder:s.formatMessage({id:"domainVerificationInput.domainInput.placeholder",defaultMessage:"No domains configured",description:"Placeholder input for adding new domains."}),value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:h.map((e=>{let{domain:t,status:r}=e;return o()(Be.ZP,{status:r,showRemoveButton:!1,isSingle:!1,format:m.l.Medium,value:t},t)}))}))},url_matching_and_placeholder:function(e){const{currentValue:t,setNewValue:r,setErrorValue:a}=e;return d().createElement(d().Fragment,null,null==t?void 0:t.map(((e,i)=>o()(_e,{currentRule:e,shouldShowDelete:0!==i,onUpdate:e=>{r([...t.slice(0,i),e,...t.slice(i+1)])},onDelete:()=>{0!==i&&r([...t.slice(0,i),...t.slice(i+1)])},onError:a},"regex-rule-".concat(i)))),o()(Pe.Z,{style:{display:"flex",alignItems:"center"},isBlue:!0,onClick:e=>{e.preventDefault(),r([...null!=t?t:[],E.VH])}},void 0,v.Z.plus({width:15,height:15}),o()(w.FormattedMessage,{id:"developerIntegrationsForm.regexPatternRulesInput.addMore.label",defaultMessage:"Add another rule",description:"A button in the 'URL matching and placeholder section. Developers can add multiple rules to match pasted URLs to their Link Preview integration."})))},external_oauth_authorize_url:Ue,external_oauth_token_url:Ue,external_client_id:Ue,external_client_secret:function(e){const{autoFocus:t,currentValue:r,setNewValue:a}=e;return o()(be.Z,{type:"password",autoFocus:t,style:{background:g.ZP.white,height:32,fontSize:15},value:r,onChange:e=>a(e.target.value)})},external_oauth_scopes:Ue,external_deletion_url:Ue};function Ue(e){const{autoFocus:t,currentValue:r,setNewValue:a}=e;return o()(be.Z,{autoFocus:t,style:{background:g.ZP.white,height:32,fontSize:15},value:r,onChange:e=>a(e.target.value)})}const De={marginTop:15,fontSize:15,fontWeight:I.Z.fontWeight.regular,color:g.ZP.frontTextMedium};function qe(e){const{spaces:t,currentValue:r,setNewValue:a,setErrorValue:i}=e,[n,l]=d().useState(!1);return(0,s.useEffect)((()=>{n||0!==t.length||(l(!0),i(o()(w.FormattedMessage,{id:"developerIntegrationsForm.spacePicker.missingSpacesError",defaultMessage:"You are not an admin of any workspaces. Please <linktonotion>create a new one</linktonotion> or ask your workspace admin to update your access.",values:{linktonotion:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o()(Q.Z,{href:(0,B.UY)("guides.joinOrCreateWorkspace")},void 0,t)}}})))}),[t,i,n]),o()(j,{keyName:"space",items:t,value:r,setValue:a,renderMenuItem:e=>d().createElement(Ie,e)})}},56200:(e,t,r)=>{r.d(t,{e:()=>g,T:()=>m});var a=r(77094),i=r.n(a),n=(r(33948),r(67294)),o=r.n(n),l=r(28350),s=r(8848),d=r(82990),u=r(81710),c=r(42001);function p(e){return"developer-integration-section-header-".concat(e)}function g(e){const{keyName:t,integrationFormStore:r}=e,a=(0,l.VK)((()=>(0,u.Le)(r.getState().startingRecord)),[r]),{title:n,subtitle:o}=a[t];return i()("div",{id:p(t),style:{fontSize:30,fontWeight:d.Z.fontWeight.bold,marginTop:24,marginBottom:24}},void 0,n,o&&i()("div",{style:{fontSize:15,color:s.ZP.frontTextLight}},void 0,o))}function m(e){const{integrationFormStore:t}=e,{type:r}=(0,l.Kw)(t),a=(0,l.VK)((()=>(0,u.Le)(t.getState().startingRecord)),[t]),n=u.cW.filter((e=>a[e].supportedBy[r])),[g,m]=o().useState(),v=g||n[0];return i()("div",{style:{display:"grid",gridTemplate:"none | auto | auto",marginTop:24,position:"sticky",top:16}},void 0,n.map((e=>i()("div",{},e,i()(c.Z,{style:{fontSize:15,height:28,marginTop:4,color:s.ZP.frontTextLight,width:"100%",...v===e&&{color:s.ZP.frontText,fontWeight:d.Z.fontWeight.medium}},onClick:()=>{const t=document.getElementById(p(e));t&&t.scrollIntoView(),m(e)}},void 0,a[e].title)))))}},81710:(e,t,r)=>{r.d(t,{cW:()=>_,Le:()=>x,fY:()=>M,yb:()=>I,x6:()=>w,hl:()=>k,Xk:()=>S,bd:()=>R,tm:()=>Z,fP:()=>T,Xr:()=>E,qv:()=>B});var a=r(77094),i=r.n(a),n=(r(33948),r(67294),r(28350)),o=r(33728),l=r(9844),s=r(75246),d=r(97880),u=r(44876),c=r(5366),p=r(45016),g=r(42402),m=r(95155),v=r(64442),f=r(70764),y=r(43348),h=r(91996),b=r(65270);const _=["secrets","basic","oauth","organization","external_oauth","unfurling"];function x(e){return{secrets:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.secrets",defaultMessage:"Secrets"}),supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["token","client_id","client_secret"]},basic:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.basic",defaultMessage:"Basic Information"}),supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["name","icon","space","developer_space","submission_type","capabilities"]},oauth:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.oauth",defaultMessage:"OAuth Domain & URIs"}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},fields:["redirect_uris","developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email"]},organization:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.links",defaultMessage:"Organization Information"}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email"]},external_oauth:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.external_oauth",defaultMessage:"External Authorization Setup"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionSubtitle.external_oauth",defaultMessage:"See the <textlink>official IETF spec</textlink> for information on OAuth 2.0.",values:{textlink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i()(g.Z,{href:"https://datatracker.ietf.org/doc/html/rfc6749",external:!0},void 0,t)}}}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},fields:["external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url"]},unfurling:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.unfurling",defaultMessage:"Unfurling Domain & Patterns"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionCaption.unfurling",defaultMessage:"Visit the <previewlab>Link Preview Lab</previewlab> to plan out unfurling previews and responses.",values:{previewlab:function(){let t="";(null==e?void 0:e.table)===l.K2&&(t=(0,p.Pk)({table:e.table,id:e.value.id}));for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return i()(g.Z,{href:t,external:!0},void 0,a)}}}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["unfurl_url","domain","url_matching_and_placeholder"]}}}function M(){const e=(0,f.QS)();return{token:{supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.label",defaultMessage:"Internal Integration Token"})},client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.integrationClientId.label",defaultMessage:"OAuth client ID"})},client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.label",defaultMessage:"OAuth client secret"})},name:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.name.label",defaultMessage:"Name"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.name.subtitle",defaultMessage:"Name to identify your integration to users."})},icon:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.icon.label",defaultMessage:"Logo"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.icon.subtitle",defaultMessage:"512px x 512px in PNG format is recommended."})},space:{supportedBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.space.label",defaultMessage:"Associated workspace"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.space.subtitle",defaultMessage:"Select a workspace to install the integration to. You can upgrade the integration to use OAuth later."})},developer_space:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerSpace.label",defaultMessage:"Associated workspace"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerSpace.subtitle",defaultMessage:"Select a workspace to install the integration to for development. Once approved it will become available to all users."})},submission_type:{supportedBy:{"create-bot":e,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":e,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.submissionType.label",defaultMessage:"Integration type"})},redirect_uris:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.redirect_uris.label",defaultMessage:"Redirect URIs"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.redirect_uri.subtitle",defaultMessage:"In the Notion OAuth flow, users will be redirected to this path after they have authenticated with Notion. The path will be appended with the authorization code for access and must have a protocol. It canâ€™t contain URL fragments, relative paths or wildcards, and canâ€™t be a public IP address. It must also be included in the token request."})},website_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.website_url.label",defaultMessage:"Website or homepage"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.website_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s website or homepage in your integration page and authentication screens."})},tagline:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.tagline.label",defaultMessage:"Tagline"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.tagline.subtitle",defaultMessage:"A short description of what the integration does."})},privacy_policy_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.privacy_policy_url.label",defaultMessage:"Privacy policy"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.privacy_policy_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s privacy policy in your integration page and authentication screens."})},terms_of_use_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.terms_of_use_url.label",defaultMessage:"Terms of use"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.terms_of_use_url.subtitle",defaultMessage:"Used to link to your integrationâ€™s terms of use in your integration page and authentication screens."})},email:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.email.label",defaultMessage:"Support email"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.email.subtitle",defaultMessage:"Used to link to your integrationâ€™s support email in your integration page and authentication screens."})},capabilities:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.label",defaultMessage:"Capabilities"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.caption",defaultMessage:"These requested capabilities will be displayed to users when they authorize your integration. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i()(g.Z,{href:"https://developers.notion.com/docs/authorization"},void 0,t)}}})},developer_name:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerName.label",defaultMessage:"Company name"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerName.caption",defaultMessage:"The name of your company or organization. You may use your own name if this does not apply."})},unfurl_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.unfurlUrl.label",defaultMessage:"Unfurl Callback URL"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.unfurlUrl.caption",defaultMessage:"Called with a POST request when an unfurl action occurs and with a DELETE request when unfurl uri preview(s) or mention(s) is deleted."})},domain:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.domain.label",defaultMessage:"Unfurl Url Domain"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.domainVerification.caption",defaultMessage:"Development and verified domains for URLs to unfurl with this integration. Domains must be verified before publishing to users. See the <textlink>Notion documentation</textlink> for more verification process.",description:"Description of the domain field for integrations and the domain verification process.",values:{textlink:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i()(g.Z,{href:"https://developers.notion.com/docs/building-a-link-preview#domain-verification",external:!0},void 0,t)}}})},url_matching_and_placeholder:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.urlMatchingAndPlaceholder.label",defaultMessage:"URL matching and placeholder",description:"Title for 'URL matching and placeholder' input in developer management site."}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.urlMatchingAndPlaceholder.caption",defaultMessage:"When users paste a URL that matches this pattern on your verified domain, they'll have the option to unfurl it as a preview. Any sample URLs are validated against provided patterns.",description:"Caption for 'URL matching and placeholder' input in developer management site."})},external_oauth_authorize_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_authorize_url.label",defaultMessage:"OAuth Authorize URL"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_authorize_url.caption",defaultMessage:"Used by Notion to initiate user authorization with the integration."})},external_oauth_token_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_token_url.label",defaultMessage:"OAuth Token URL"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_token_url.caption",defaultMessage:"Called by Notion to retrieve an access token for the unfurl callback URL."})},external_oauth_scopes:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_scopes.label",defaultMessage:"OAuth Scopes (Optional)"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_scopes.caption",defaultMessage:"Optional scopes string"})},external_client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_client_id.label",defaultMessage:"OAuth Client ID"})},external_client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_client_secret.label",defaultMessage:"OAuth Client Secret"})},external_deletion_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_deletion_url.label",defaultMessage:"Deleted Token Callback URL (Optional)",description:"Shown in a configuration page for a Notion integration."}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_deletion_url.caption",defaultMessage:"Called by Notion when a user removes your integration.",description:"Shown in a configuration page for a Notion integration, below the heading 'Deleted Token Callback URL (Optional)'."})}}}const F={value:void 0,error:void 0},I={token:F,client_id:F,client_secret:F,name:F,icon:F,space:F,developer_space:F,submission_type:F,tagline:F,email:F,website_url:F,privacy_policy_url:F,terms_of_use_url:F,redirect_uris:F,capabilities:F,developer_name:F,unfurl_url:F,domain:F,url_matching_and_placeholder:F,external_oauth_authorize_url:F,external_oauth_token_url:F,external_client_id:F,external_client_secret:F,external_oauth_scopes:F,external_deletion_url:F};function w(e,t){return"error"in t?{...e,[t.field]:{...e[t.field],error:t.error}}:{...e,[t.field]:{...e[t.field],...t.value&&{error:void 0},value:t.value}}}function k(e){const{userRootStore:t,formStoreState:r}=e;if("create-bot"===r.type){return{token:void 0,client_id:void 0,client_secret:void 0,space:(t?t.getAdminSpaceStores():[])[0],submission_type:r.recordTypeOnSubmission,developer_name:void 0,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,redirect_uris:void 0,capabilities:{read_content:!0,insert_content:!0,update_content:!0,read_comment:!1,insert_comment:!1,read_user_with_email:!0,read_user_without_email:!0},unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-bot"===r.type||"create-guest-integration"===r.type){const e=r.startingRecord.value,a=t&&v.Z.createChildStore(t,{id:e.space_id,table:s.bx});return{token:r.startingRecord,client_id:void 0,client_secret:void 0,name:e.name,icon:e.icon,space:a,developer_space:void 0,submission_type:r.recordTypeOnSubmission,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,redirect_uris:void 0,capabilities:C(e.capabilities),developer_name:void 0,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-guest-integration"===r.type){const e=r.startingRecord.value;return{token:void 0,client_id:r.startingRecord,client_secret:r.startingRecord,name:e.name,icon:e.info.icon,space:void 0,developer_space:void 0,submission_type:r.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,redirect_uris:e.redirect_uris,capabilities:C(e.capabilities),developer_name:e.info.developer_name,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("create-third-party-external-integration"===r.type){return{token:void 0,client_id:void 0,client_secret:void 0,space:void 0,developer_space:(t?t.getAdminSpaceStores():[])[0],submission_type:r.recordTypeOnSubmission,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,redirect_uris:void 0,capabilities:void 0,developer_name:void 0,unfurl_url:void 0,domain:{developmentDomain:b.nZ,verifiedDomains:[],domainVerifications:[]},url_matching_and_placeholder:[b.VH],external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-third-party-external-integration"===r.type){var a,i;const e=r.startingRecord.value,n=null===(a=r.startingAuthRecord)||void 0===a?void 0:a.value,o=r.domainVerifications,l=e.info.developer_space_id,c=l&&t?v.Z.createChildStore(t,{id:l,table:s.bx}):void 0,p=e.info.original_url_patterns||[],g={developmentDomain:(null===(i=e.info.development_url_domains)||void 0===i?void 0:i[0])||"",verifiedDomains:e.info.original_url_domains||[],domainVerifications:o},m=p.map((t=>{var r,a,i;if(!0!==(null===(r=t.additional_types)||void 0===r?void 0:r.collection))return{name:(0,y.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:(null!==(a=null==t?void 0:t.attributes)&&void 0!==a?a:[]).map(u.Ah),sampleUrls:null!==(i=null==t?void 0:t.sample_urls)&&void 0!==i?i:[]}})).filter(d.$K);return{token:void 0,client_id:r.startingRecord,client_secret:r.startingRecord,name:e.name,icon:e.info.icon,space:void 0,developer_space:c,submission_type:r.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,redirect_uris:e.redirect_uris,capabilities:void 0,developer_name:e.info.developer_name,domain:g,url_matching_and_placeholder:m,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:null==n?void 0:n.oauth_authorize_url,external_oauth_token_url:null==n?void 0:n.oauth_token_url,external_client_id:null==n?void 0:n.client_id,external_client_secret:null==n?void 0:n.client_secret,external_oauth_scopes:null==n?void 0:n.scopes,external_deletion_url:null==n?void 0:n.deletion_url}}if("update-first-party-external-integration"===r.type){var n,o;const e=r.startingRecord.value,a=e.info.developer_space_id,i=a&&t?v.Z.createChildStore(t,{id:a,table:s.bx}):void 0,l=e.info.original_url_patterns||[],c={developmentDomain:(null===(n=e.info.development_url_domains)||void 0===n?void 0:n[0])||"",verifiedDomains:null!==(o=e.info.original_url_domains)&&void 0!==o?o:[],domainVerifications:[]},p=l.map((t=>{var r,a,i;if(!0!==(null===(r=t.additional_types)||void 0===r?void 0:r.collection))return{name:(0,y.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:(null!==(a=null==t?void 0:t.attributes)&&void 0!==a?a:[]).map(u.Ah),sampleUrls:null!==(i=null==t?void 0:t.sample_urls)&&void 0!==i?i:[]}})).filter(d.$K);return{token:void 0,client_id:r.startingRecord,client_secret:r.startingRecord,name:e.name,icon:e.info.icon,space:void 0,developer_space:i,submission_type:r.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,redirect_uris:e.redirect_uris,capabilities:void 0,developer_name:e.info.developer_name,domain:c,url_matching_and_placeholder:p,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}(0,d.t1)(r)}function S(e){const{formData:t,formStateType:r}=e,a=[],i=M();for(const n of(0,d.Yd)(i)){const e=t[n].value;i[n].requiredBy[r]&&!e&&a.push(n)}return a}function R(e){const{formData:t,formStateType:r}=e,a=[];for(const n of(0,d.Yd)(t)){const e=t[n].value,o=M()[n].supportedBy[r],l=h.tV[n];if(o&&e&&l){const r=l({value:e,formData:t});var i;if(!r.validated)a.push({fieldName:n,errorMessages:null===(i=r.errorMessages)||void 0===i?void 0:i.map((e=>{let{descriptor:t,values:r}=e;return{descriptor:t,values:null!=r?r:{}}}))})}}return a}function Z(e){const{formData:t,formStateType:r}=e;return(0,d.Yd)(t).some((e=>M()[e].supportedBy[r]&&t[e].error))}const T={read_content:!1,update_content:!1,insert_content:!1,read_user_without_email:!1,read_user_with_email:!1,read_comment:!1,insert_comment:!1};function C(e){const t={...T};return e&&Object.entries(e).forEach((e=>{let[r,a]=e;a&&(t[r]=!0)})),t}function P(e){if(!e)return;const t={};return Object.entries(e).forEach((e=>{let[r,a]=e;a&&(t[r]=!0)})),t}function E(e){return{token:e.token.value,client_id:e.client_id.value,client_secret:e.client_secret.value,name:e.name.value,icon:e.icon.value,space:e.space.value,submission_type:e.submission_type.value,redirect_uris:(e.redirect_uris.value||[]).map((e=>h.FR(e))),website_url:h.FR(e.website_url.value),tagline:e.tagline.value,privacy_policy_url:h.FR(e.privacy_policy_url.value),terms_of_use_url:h.FR(e.terms_of_use_url.value),email:o.H3(e.email.value),capabilities:P(e.capabilities.value),developer_name:e.developer_name.value,developer_space:e.developer_space.value,unfurl_url:e.unfurl_url.value,domain:e.domain.value,url_matching_and_placeholder:e.url_matching_and_placeholder.value,external_oauth_authorize_url:h.FR(e.external_oauth_authorize_url.value),external_oauth_token_url:h.FR(e.external_oauth_token_url.value),external_client_id:e.external_client_id.value,external_client_secret:e.external_client_secret.value,external_oauth_scopes:e.external_oauth_scopes.value,external_deletion_url:h.FR(e.external_deletion_url.value)}}function B(){return{enableReadCommentsApi:"on"===(0,n.VK)((()=>m.default.getEligibleGroup({experimentId:"enable_read_comments_public_api",defaultGroup:"control"})),[]),enableWriteCommentsApi:"on"===(0,n.VK)((()=>m.default.getEligibleGroup({experimentId:"enable_write_comments_public_api",defaultGroup:"control"})),[])}}},91996:(e,t,r)=>{r.d(t,{Jv:()=>v,FR:()=>_,tV:()=>F});r(33948);var a=r(33728),i=r(20270),n=r(74181),o=r(89602),l=r(97880),s=r(44876),d=r(64002),u=r(63143),c=r(36054),p=r(5366),g=r(95477);const m=(0,p.defineMessages)({capabilityErrorMessage:{id:"developerIntegrationsCreate.error.capabilities.invalidContent2",defaultMessage:"At least one capability must be requested.",description:"Error message that a developer should request at least one capability for their integration"},regexPatternErrorMessage:{id:"developerIntegrationFormValidator.urlMatchingAndPlaceholder.regex.error",defaultMessage:"{value} regex pattern is invalid.",description:"Value will be the developer named link preview pattern. (e.g. github_pull_request pattern is invalid."},regexAttributesErrorMessage:{id:"developerIntegrationFormValidator.urlMatchingAndPlaceholder.attributes.error",defaultMessage:"{value} attributes JSON does not match request schema.",description:"Value will be the developer named link preview pattern. (e.g. github_pull_request attributes JSON does not match request schema."},sampleUrlMissingDomain:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlMissingDomain.error",defaultMessage:'URL "{value}" is missing a domain.',description:"Value will be a developer configured URL. Error appears if URL is misconfigured."},sampleUrlDoesNotMatchProvidedDomain:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlDoesNotMatchProvidedDomain.error",defaultMessage:'URL "{value}" does not match a provided domain.',description:"Value will be a developer configured URL. Error appears if URL doesn't match the configured domain (e.g. google.com)"},sampleUrlDoesNotMatchProvidedRegexes:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlDoesNotMatchProvidedRegexes.error",defaultMessage:'URL "{value}" does not match a provided regex pattern.',description:"Value will be a developer configured URL. Error appears if URL doesn't match a configured regex pattern."}});function v(e){let t;try{t=JSON.parse(e)}catch(r){t=void 0}return t}function f(e){const{value:t}=e,r=d.yn(t);if(!r)return{validated:!1};return d.Qc(r).hostname?{validated:!0}:{validated:!1}}function y(e){try{return new RegExp(e),{validated:!0}}catch{return{validated:!1}}}function h(e){if((0,c.Gu)(o.$1,e))return{validated:!1};for(const t of e){const e=(0,s.GY)(t);if(!(0,i.nj)(e))return{validated:!1}}return{validated:!0}}function b(e){const{domains:t,regex:r,urls:a}=e;if(0===a.length)return[];const i=[];for(const n of a){const e=(0,s.XR)({url:n,domains:t,regex:new RegExp(r)});"invalid_url"===e.type?i.push({descriptor:m.sampleUrlMissingDomain,value:n}):"url_does_not_match_domain"===e.type?i.push({descriptor:m.sampleUrlDoesNotMatchProvidedDomain,value:n}):"url_does_not_match_regex"===e.type?i.push({descriptor:m.sampleUrlDoesNotMatchProvidedRegexes,value:n}):"success"===e.type||(0,l.t1)(e)}return i}function _(e){const t=d.yn(e);if(!t||!e)return;const r=t[t.length-1],a=e[e.length-1];return"/"===r&&"/"!==a?t.slice(0,t.length-1):t}const x={insert_comment:!0,insert_content:!0,read_comment:!0,read_content:!0,update_content:!0,read_user_with_email:!1,read_user_without_email:!1},M=(0,l.Yd)(x).filter((e=>x[e]));const F={email:function(e){const{value:t}=e,r=a.H3(t);return r?{validated:a.oH(r).valueOf()}:{validated:!1}},redirect_uris:function(e){const{value:t}=e;return{validated:t.every((e=>(0,n.mb)(g.default.domainBaseUrl,e)))}},website_url:f,privacy_policy_url:f,terms_of_use_url:f,capabilities:function(e){const{value:t}=e;return M.some((e=>t[e]))?{validated:!0}:{validated:!1,errorMessages:[{descriptor:m.capabilityErrorMessage}]}},unfurl_url:f,url_matching_and_placeholder:function(e){const{value:t,formData:r}=e,a=[];for(const o of t){if(y(o.regex).validated){var i;const e=b({domains:(n=null===(i=r.domain)||void 0===i?void 0:i.value,n?(0,u.jj)([...n.developmentDomain&&[n.developmentDomain],...n.domainVerifications.map((e=>{let{domain:t}=e;return t})),...n.verifiedDomains]):[]),regex:o.regex,urls:o.sampleUrls});a.push(...e)}else a.push({descriptor:m.regexPatternErrorMessage,value:o.name});h(o.attributes).validated||a.push({descriptor:m.regexAttributesErrorMessage,value:o.name})}var n;return a.length>0?{validated:!1,errorMessages:a.map((e=>{let{descriptor:t,value:r}=e;return{descriptor:t,values:{value:r}}}))}:{validated:!0}},external_oauth_authorize_url:f,external_oauth_token_url:f,external_deletion_url:f}},65270:(e,t,r)=>{r.d(t,{TG:()=>m,rn:()=>v,C:()=>f,Az:()=>y,nZ:()=>h,e_:()=>b,P4:()=>_,VH:()=>x,SV:()=>M,VR:()=>w,Hx:()=>k});r(99244),r(33948);var a=r(26263),i=r(41432),n=r(20270),o=r(4615),l=r(21202),s=r(19889),d=r(70203),u=r(97880),c=r(44876),p=r(63143),g=r(9714);function m(e){return(0,p.jj)(e.flatMap((e=>{if("relation"===e.type)return e.relation.uri})).filter(u.$K))}function v(e){const{environment:t,integration:r,rootUrl:u,rootAttributes:p,relatedUrisToAttributes:m}=e,v=(0,o.ZP)(),f=t.currentUser.id,y=new a.Z,h=[],b={};for(const[a,i]of Object.entries(m)){const e=(0,o.ZP)();h.push({id:e,uri:a,attributes:i}),b[a]=e}const _=[{id:"rootInstanceId",original_url:u,attributes:p,related_external_object_uris_to_instance_ids:b},...h].map((e=>{const t=[];for(const r of e.attributes){const e=(0,c.GY)(r);(0,n.nj)(e)&&t.push(e)}return{...e,attributes:t}}));if("success"!==(0,c.ny)({url:u,integrations:[r],currentSpaceId:v}).type)return{error:"Sample URL does not match provided integration regex."};const x={table:l.iU,id:(0,o.ZP)(),spaceId:v};let M;for(const a of _){const e={table:l.iU,id:a.id,spaceId:v},t={...a,domain:"test"},r={id:a.id,type:i.ZP.externalObjectInstance,version:0,created_at:0,created_by_table:s.KJ,created_by_id:(0,o.ZP)(),last_edited_time:0,last_edited_by_table:s.KJ,last_edited_by_id:(0,o.ZP)(),parent_table:l.iU,parent_id:(0,o.ZP)(),space_id:v,alive:!0,domain:"",format:t};if(y.setRecord({pointer:e,userId:f},{role:"editor",value:r}),a===_[0]){const a={...r,format:{...t,attributes:void 0}};y.setRecord({pointer:x,userId:f},{role:"editor",value:a}),M=e}}if(!M)return{error:"Root external object was not defined."};const F=new g.Z(t,x,{inMemoryRecordCache:y}),I=new g.Z(t,M,{inMemoryRecordCache:y}),w={table:l.iU,id:(0,o.ZP)(),spaceId:v},k=new g.Z(t,w,{inMemoryRecordCache:y}),S={id:w.id,type:"text",version:0,space_id:v,parent_id:(0,o.ZP)(),parent_table:l.iU,alive:!0,properties:{title:[(0,d.YC)((0,d.x3)(x.id))]}};y.setRecord({pointer:w,userId:f},{role:"editor",value:S});const R={table:l.iU,id:(0,o.ZP)(),spaceId:v},Z=new g.Z(t,R,{inMemoryRecordCache:y}),T={id:R.id,type:"text",version:0,space_id:v,parent_id:(0,o.ZP)(),parent_table:l.iU,alive:!0,properties:{title:[(0,d.YC)((0,d.x3)(_[0].id))]}};return y.setRecord({pointer:R,userId:f},{role:"editor",value:T}),{emptyInstanceBlockStore:F,previewBlockStore:I,emptyInlineBlockStore:k,inlineBlockStore:Z}}const f=(0,o.ZP)(),y="https://acme.com/items/23487",h="acme.com",b="^(?<site>https\\:\\/\\/acme\\.com)\\/items\\/(?<itemNo>\\d+)$",_=[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Acme Item #$<itemNo>",section:"title"}}},{id:"itemId",name:"Item Id",type:"inline",inline:{plain_text:{value:"#$<itemNo>",section:"identifier"}}},{id:"site",name:"Site",type:"inline",inline:{plain_text:{value:"$<site>",section:"secondary"}}}],x={name:"item",regex:b,attributes:_,sampleUrls:[y]},M=[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Feature Request: Link Previews",section:"title"}}},{id:"state",name:"State",type:"relation",relation:{uri:"acme:item_state/open",mention:{section:"primary"}}},{id:"itemId",name:"Item Id",type:"inline",inline:{plain_text:{value:"#23487",section:"identifier"}}},{id:"itemIcon",name:"Item Icon",type:"inline",inline:{color:{value:{r:247,g:247,b:42},section:"entity"}}},{id:"user",name:"User",type:"relation",relation:{uri:"https://acme.com/fig-ment",extension:[{id:"title",section:"secondary"},{id:"avatar_url",section:"avatar"}]}},{id:"description",name:"Description",type:"inline",inline:{plain_text:{value:"Would love to be able to preview some Acme resources in Notion!\n Maybe an open item?",section:"body"}}},{id:"updated_at",name:"Updated At",type:"inline",inline:{datetime:{value:"2022-01-11T19:53:18.829Z",section:"secondary"}}},{id:"label",name:"Label",type:"inline",inline:{enum:{value:"ğŸ”¨ Ready to Build",color:{r:100,g:100,b:100},section:"primary"}}}],F={uri:"https://acme.com/fig-ment",attributes:[{id:"title",name:"User Name",type:"inline",inline:{title:{value:"fig"}}},{id:"avatar_url",name:"Avatar URL",type:"embed",embed:{src_url:"https://avatars.githubusercontent.com/u/93556354?s=88&u=4967f0be0900684b6963a953ca7fe0ff2268746f&v=4",image:{}}}]},I={uri:"acme:item_state/open",attributes:[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Open",section:"title"}}},{id:"icon",name:"Icon",type:"embed",embed:{src_url:"/images/external_integrations/acme-icon.png",image:{section:"avatar"}}},{id:"color",name:"Color",type:"inline",inline:{color:{value:{r:235,g:64,b:52},section:"background"}}}]};function w(){const e=[F,I],t=m(M),r={};for(const a of t){const t=e.find((e=>e.uri===a));t&&(r[a]=t.attributes)}return r}function k(e){const{domain:t,regex:r,currentIntegration:a}=e,i={...a.info,original_url_domains:[t],original_url_patterns:[{name:"acme-issue",regex:r,attributes:e.attributes.map((e=>{const t=(0,c.GY)(e);if((0,n.nj)(t))return t})).filter(u.$K)}]};return{...a,info:i}}},85227:(e,t,r)=>{r.d(t,{Z:()=>u});var a=r(49085),i=r(77420),n=r(9844),o=r(51878),l=r(97880),s=r(52507);class d extends a.Z{getInitialState(){return{type:"create-bot",startingRecord:void 0,recordTypeOnSubmission:"internal",status:"unpublished"}}updateRecordTypeOnSubmission(e){"create-bot"===this.state.type?"unfurling"===e&&this.setState({type:"create-third-party-external-integration",startingRecord:this.state.startingRecord,startingAuthRecord:void 0,recordTypeOnSubmission:e,status:"unpublished"}):"update-bot"===this.state.type?"public"===e&&this.setState({type:"create-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"create-guest-integration"===this.state.type?"internal"===e&&this.setState({type:"update-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"update-guest-integration"===this.state.type||("create-third-party-external-integration"===this.state.type?"internal"===e&&this.setState({type:"create-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"update-third-party-external-integration"===this.state.type||"update-first-party-external-integration"===this.state.type||(0,l.t1)(this.state))}initializeNewForm(e,t,r){if(e.table===i.cZ)this.setState({type:"update-bot",startingRecord:e,recordTypeOnSubmission:"internal",status:"unpublished"});else if(e.table===n.K2)if("external"===e.value.type)if((0,o.BP)(e.value.id))this.setState({type:"update-first-party-external-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"unfurling",status:e.value.status});else{if(!t)return;const a=r.map((e=>({type:e.verified_at?"verified":"unverified",id:e.id,domain:e.domain,verificationCode:e.verification_code,createdAt:e.created_at,expiresAt:e.expires_at,alive:e.alive})));this.setState({type:"update-third-party-external-integration",startingRecord:{table:e.table,value:e.value},startingAuthRecord:t,recordTypeOnSubmission:"unfurling",status:e.value.status,domainVerifications:a,domainVerificationStore:"update-third-party-external-integration"===this.state.type?this.state.domainVerificationStore:new s.ZP})}else this.setState({type:"update-guest-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"public",status:e.value.status});else(0,l.t1)(e)}}const u=d},89602:(e,t,r)=>{r.d(t,{$1:()=>R});var a=r(14710),i=r(74487);const n=i.Ry({required:{r:i.G(i.eg(i._L(),0),255),g:i.G(i.eg(i._L(),0),255),b:i.G(i.eg(i._L(),0),255)},optional:{}}),o=i.Ry({required:{value:i.G0([i.Z_(),i.v2(i.IX(i.Z_()))])},optional:{section:i.eR(a.kE.avatar,a.kE.identifier,a.kE.primary,a.kE.secondary,a.kE.body)}}),l=i.Ry({required:{value:i.G0([i.O7(),i.v2(i.IX(i.O7()))])},optional:{}}),s=i.Ry({required:{value:i.G0([i.Rx(),i.v2(i.IX(i.Rx()))])},optional:{}}),d=i.Ry({required:{value:i.G0([i.Z_(),i.v2(i.IX(i.Z_()))])},optional:{color:n,section:i.eR(a.kE.primary)}}),u=i.Ry({required:{value:i.G0([i.Z_(),i.bc([i.Z_()])])},optional:{color:n,section:i.i0(a.kE.title)}}),c=i.Ry({required:{value:i.G0([n,i.v2(i.IX(n))])},optional:{section:i.eR(a.kE.entity,a.kE.background)}}),p=i.Ry({required:{value:i.G0([i.ur(),i.v2(i.IX(i.ur()))])},optional:{section:i.eR(a.kE.primary,a.kE.secondary)}}),g=i.Ry({required:{value:i.G0([i.ur(),i.v2(i.IX(i.ur()))])},optional:{section:i.eR(a.kE.primary,a.kE.secondary)}}),m=i.Ry({required:{value:i.G0([i.ur(),i.bc([i.ur()])])},optional:{section:i.eR(a.kE.primary,a.kE.secondary)}}),v=i.Ry({required:{value:i.G0([i.ur(),i.bc([i.ur()])])},optional:{section:i.eR(a.kE.primary,a.kE.secondary)}}),f=i.G0([i.Ry({required:{plain_text:o},optional:{type:i.i0("plain_text")}}),i.Ry({required:{boolean:l},optional:{type:i.i0("boolean")}}),i.Ry({required:{number:s},optional:{type:i.i0("number")}}),i.Ry({required:{enum:d},optional:{type:i.i0("enum")}}),i.Ry({required:{title:u},optional:{type:i.i0("title")}}),i.Ry({required:{color:c},optional:{type:i.i0("color")}}),i.Ry({required:{date:p},optional:{type:i.i0("date")}}),i.Ry({required:{datetime:g},optional:{type:i.i0("datetime")}}),i.Ry({required:{created_datetime:m},optional:{type:i.i0("created_datetime")}}),i.Ry({required:{last_edited_datetime:v},optional:{type:i.i0("last_edited_datetime")}})]),y=i.Ry({required:{},optional:{section:i.i0(a.kE.embed)}}),h=i.Ry({required:{},optional:{section:i.i0(a.kE.embed)}}),b=i.Ry({required:{},optional:{section:i.i0(a.kE.embed)}}),_=i.Ry({required:{},optional:{section:i.i0(a.kE.embed)}}),x=i.Ry({required:{},optional:{format:i.AG(i.eR("icon")),section:i.eR(a.kE.avatar,a.kE.entity,a.kE.embed)}}),M=i.jV([i.Ry({required:{src_url:i.G0([i.Z_(),i.v2(i.IX(i.Z_()))])},optional:{}}),i.G0([i.Ry({required:{html:y},optional:{type:i.i0("html")}}),i.Ry({required:{pdf:h},optional:{type:i.i0("pdf")}}),i.Ry({required:{audio:b},optional:{type:i.i0("audio")}}),i.Ry({required:{video:_},optional:{type:i.i0("video")}}),i.Ry({required:{image:x},optional:{type:i.i0("image")}})])]),F=i.G0([i.Z_(),i.v2(i.IX(i.Z_()))]),I=i.Ry({required:{uri:F},optional:{type:i.i0("mention"),mention:i.Ry({required:{},optional:{section:i.i0(a.kE.primary)}}),extension:i.Ft()}}),w=i.Ry({required:{uri:F},optional:{type:i.i0("extension"),extension:i.v2(i.IX(i.Ry({required:{id:i.Z_()},optional:{section:i.eR(a.kE.avatar,a.kE.embed,a.kE.primary,a.kE.secondary)}}))),mention:i.Ft()}}),k=i.G0([I,w]),S=i.jV([i.Ry({required:{id:i.Z_(),name:i.Z_()},optional:{}}),i.G0([i.Ry({required:{inline:f},optional:{type:i.i0("inline")}}),i.Ry({required:{embed:M},optional:{type:i.i0("embed")}}),i.Ry({required:{relation:k},optional:{type:i.i0("relation")}})])]),R=i.IX(S)}}]);