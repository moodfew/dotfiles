"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[567],{82276:(e,t,s)=>{s.d(t,{T:()=>b});var a=s(97464),o=s.n(a),i=s(77094),r=s.n(i),n=s(67294),l=s.n(n),d=s(24405),p=s(3779),m=s(26825),c=s(5366),g=s(86646);function u(e){const{enabled:t,labelIfEnabled:s,labelIfDisabled:a}=e,o=(0,d.y)((e=>({container:{color:t?e.mediumTextColor:e.lightTextColor}})),[t]);return r()("div",{style:o.container},void 0,function(e){const t={width:12,display:"inline",verticalAlign:"middle"};return e?p.Z.thinCheck(t):p.Z.close(t)}(t)," ",t?s:a)}function b(e){const{role:t,renderUserCapabilities:s}=e,a=(0,d.F)(),i=(0,c.useIntl)();return"object"!=typeof t?r()("div",{}):l().createElement(g.Z,o()({},e,{title:i.formatMessage((0,m.Gx)(t,void 0).label),shouldWrapCaption:!0,style:{padding:4,marginTop:2,marginBottom:2},captionStyle:{marginTop:4},caption:r()("div",{},void 0,r()(u,{enabled:t.read_content,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.mixedAccess.readContent.enabled",defaultMessage:"Can read content."}),labelIfDisabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.readContent.disabled",defaultMessage:"Cannot read content."})}),r()(u,{enabled:t.insert_content,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.insertContent.enabled",defaultMessage:"Can insert content."}),labelIfDisabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.insertContent.disabled",defaultMessage:"Cannot insert content."})}),r()(u,{enabled:t.update_content,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.updateContent.enabled",defaultMessage:"Can update content."}),labelIfDisabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.updateContent.disabled",defaultMessage:"Cannot update content."})}),t.insert_comment&&r()(u,{enabled:!0,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.insertComment.enabled",defaultMessage:"Can comment.",description:"Label indicating that an integration can comment on a page"}),labelIfDisabled:null}),t.read_comment&&r()(u,{enabled:!0,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.readComment.enabled",defaultMessage:"Can read comments.",description:"Label indicating that an integration can read comments on a page"}),labelIfDisabled:null}),s?h(t,a):r()("div",{}))}))}function h(e,t){if("object"!=typeof e)return;const s=Boolean("read_user_without_email"in e&&e.read_user_without_email),a=Boolean("read_user_with_email"in e&&e.read_user_with_email);return r()("div",{},void 0,r()(u,{enabled:s,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUsers.enabled",defaultMessage:"Can view users."}),labelIfDisabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUsers.disabled",defaultMessage:"Cannot view users."})}),r()(u,{enabled:a,labelIfEnabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUserEmailAddresses.enabled",defaultMessage:"Can view user email addresses."}),labelIfDisabled:r()(c.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUserEmailAddresses.disabled",defaultMessage:"Cannot view user email addresses."})}))}},7567:(e,t,s)=>{s.d(t,{Z:()=>j});var a=s(97464),o=s.n(a),i=s(77094),r=s.n(i),n=s(77422),l=s.n(n),d=(s(33948),s(67294)),p=s.n(d),m=s(83355),c=s(41892),g=s(8848),u=s(3779),b=s(26825),h=s(27006),M=s(75246),f=s(97880),v=s(5366),y=s(47307),w=s(93678),C=s(95477),_=s(43250),F=s(98742),P=s(67669),R=s(1643),k=s(27832),T=s(61766),Z=s(60709),E=s(48762),I=s(46167),A=s(82276),S=s(71202),U=s(86646),x=s(25584),L=s(26524),q=s(42001),D=s(83071),W=s(37235),B=s(60442),O=s(46951),N=s(42115);class z extends m.Z{constructor(){super(...arguments),l()(this,"storeTypes",{buttonPopupStore:T.Z}),l()(this,"renderPermissionOverrideLabel",(()=>{const{device:e}=this.environment;return r()(O.Z,{style:{padding:12,backgroundColor:this.theme.sidebarSecondaryBackground,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor),marginTop:e.isMobile?28:1},isMultiline:!0,isSmall:!0},void 0,r()(v.FormattedMessage,{id:"permissionRoleSelect.overrideMessage.caption",defaultMessage:"Youâ€™ll override permissions from the parent page if you change this role."}))})),l()(this,"isRemovingSelfRole",(e=>this.props.isUserPermission&&(0,b.nl)(this.props.role,e)===this.props.role&&"none"===e)),l()(this,"isDowngradingSelfRole",(e=>this.props.isUserPermission&&(0,b.nl)(this.props.role,e)===this.props.role)),l()(this,"handleSelectChange",(e=>{const{table:t}=this.props,s=()=>{this.props.onChange&&this.props.onChange(e)};this.getItemDisabledReason(e)&&!C.default.isAdminMode?(w.y(this.environment,{from:this.props.upgradeButtonName,for:R.M9(this.environment)||"team"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()):this.isRemovingSelfRole(e)?y.showDialog({showCancel:!0,keepFocus:!1,message:t===M.bx?r()(v.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfFromWorkspace.confirmationMessage",defaultMessage:"Are you sure you want to remove your own access? You will lose access to the workspace, and any private pages will be lost."}):r()(v.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfFromPage.confirmationMessage",defaultMessage:"Are you sure you want to remove your own access?"}),items:[{label:r()(v.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfButton.label",defaultMessage:"Remove"}),color:"red",onAccept:s}]}):this.isDowngradingSelfRole(e)?y.showDialog({showCancel:!0,keepFocus:!1,message:r()(v.FormattedMessage,{id:"userPermissionsMenu.downgradePermissionsModal.downgradeSelfFromWorkspaceOrPage.confirmationMessage",defaultMessage:"Are you sure you want to downgrade your own access?",description:"Warning that shows when you try to downgrade your own space role"}),items:[{label:r()(v.FormattedMessage,{id:"userPermissionsMenu.downgradePermissionsModal.downgradeSelfButton.label",defaultMessage:"Downgrade",description:"Downgrade self button label in settings modal"}),color:"red",onAccept:s}]}):this.isRemovingSpaceUser(e)?y.showDialog({showCancel:!0,keepFocus:!1,message:t===M.bx?r()(v.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserFromWorkspace.confirmationMessage",defaultMessage:"Are you sure you want to remove this person? They will lose access to the workspace, and any private pages will be lost."}):r()(v.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserFromPage.confirmationMessage",defaultMessage:"Are you sure you want to remove this person?"}),items:[{label:r()(v.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserButton.label",defaultMessage:"Remove"}),color:"red",onAccept:s}]}):s()}))}renderComponent(){const{device:e}=this.environment;return r()(I.Z,{onClick:e=>{e.stopPropagation()},popupType:e.isMobile?I.Z.PopupType.SlideUp:I.Z.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>this.props.origin?this.props.origin:this.props.isMenuItem?p().createElement(E.Z,o()({},e,{title:p().createElement(v.FormattedMessage,this.getItemLabelAndCaption(this.props.role).label),focused:!1,showExtensionArrow:!0})):p().createElement(q.Z,o()({disabled:this.props.disabled,style:{marginRight:8,...this.props.buttonStyle}},e),this.props.buttonContents||r()("span",{className:"notranslate"},void 0,p().createElement(v.FormattedMessage,this.getItemLabelAndCaption(this.props.role).label)),!this.props.disabled&&u.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),placementToOrigin:Z.Iw.Bottom,render:t=>{let s,a;if((0,b.oF)(this.props.role))s=[{key:"mixed_role_section",render:e=>p().createElement(D.Z,o()({},e,{topBorder:!1})),items:[{key:"mixed_role_description",render:()=>r()(A.T,{role:this.props.role,renderUserCapabilities:!1}),action:()=>{}}]},{key:"bot_capabilities_warning",render:e=>p().createElement(D.Z,o()({},e,{topBorder:!0})),items:[{key:"warning_details",render:e=>p().createElement(U.Z,o()({},e,{shouldWrapCaption:!0,caption:"Integration permissions cannot be changed on a page. You can manage integrations in settings."})),action:()=>{}}]},{key:"remove_bot",render:e=>p().createElement(D.Z,o()({},e,{topBorder:!0})),items:[{key:"none",render:e=>this.getItem({role:"none"},e.focused,e),action:()=>{this.handleSelect("none"),t.close()}}]}];else{s=[{key:"roles",render:e=>p().createElement(D.Z,o()({},e,{topBorder:0!==e.index})),items:this.getAvailableRoles().map((e=>({key:e.role,render:t=>this.getItem(e,t.focused,t),action:()=>{this.handleSelect(e.role),t.close()}})))}]}return a=e.isMobile?{menuType:S.ZP.MenuType.Modal,title:r()(v.FormattedMessage,{id:"userPermissionsMenu.mobile.title",defaultMessage:"Select role"}),right:r()(v.FormattedMessage,{id:"userPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:t.close}:{menuType:S.ZP.MenuType.Popup,width:264},p().createElement(S.ZP,o()({className:_.a6,header:this.props.header,footer:this.props.footer},a),r()(x.Z,{type:x.Z.Type.Vertical,initialFocus:void 0,sections:s}),this.props.showPermissionOverrideWarning&&this.renderPermissionOverrideLabel())}})}getItemLabelAndCaption(e){if("object"==typeof e)return(0,b.Gx)(e,this.props.table);switch(e){case"editor":return this.props.table===M.bx?(0,P.Ri)()?{label:b.mq.workspaceOwnerLabel,caption:b.mq.workspaceOwnerCaption}:{label:b.mq.adminLabel,caption:b.mq.adminCaption}:{label:b.mq.fullAccessLabel,caption:b.mq.fullAccessCaption};case"membership_admin":return this.props.table===M.bx?{label:b.mq.membershipAdminLabel,caption:b.mq.membershipAdminCaption}:{label:b.mq.canEditLabel,caption:b.mq.canEditCaption};case"read_and_write":return this.props.table===M.bx?{label:b.mq.memberLabel,caption:b.mq.memberCaption}:{label:b.mq.canEditLabel,caption:b.mq.canEditCaption};case"content_only_editor":return{label:b.mq.canEditContentLabel,caption:b.mq.canEditContentCaption};case"reader":return{label:b.mq.canReadLabel,caption:b.mq.canReadCaption};case"comment_only":return{label:b.mq.canCommentLabel,caption:b.mq.canCommentCaption};case"none":return"user_permission"===this.props.type||"bot_permission"===this.props.type||"group_permission"===this.props.type?this.props.table===M.bx?this.props.isUserPermission?{label:b.mq.leaveWorkspaceLabel,style:{color:g.ZP.red}}:{label:b.mq.removeFromWorkspaceLabel,style:{color:g.ZP.red}}:{label:b.mq.removeWorkspaceLabel,style:{color:g.ZP.red}}:{label:b.mq.noAccessLabel,style:{color:g.ZP.red}};default:(0,f.t1)(e)}}getItem(e,t,s){return this.renderItem({...this.getItemLabelAndCaption(e.role),focused:t,props:s,disabledMessage:this.getItemDisabledReason(e.role),availableRole:e})}renderItem(e){const{device:t}=this.environment,{onClick:s,key:a,...i}=e.props,n=e.availableRole.disabledInfo;return n&&n.isDisabled?r()(W.Z,{delayThreshold:0,renderTooltip:e=>p().createElement("div",e,n.disabledMessage),placement:W.Z.Placement.Right,render:s=>p().createElement(E.Z,o()({},s,{focused:e.focused,disabled:!0,disabledFeedback:!0,right:this.props.role===e.availableRole.role?r()("div",{style:{width:t.isMobile?16:14}},void 0,u.Z.check()):void 0,title:r()("div",{style:{display:"flex",alignItems:"center"}},void 0,r()("div",{style:{...e.style,marginRight:e.disabledMessage?6:0}},void 0,p().createElement(v.FormattedMessage,e.label))),caption:e.caption&&r()("span",{style:{color:this.theme.mediumTextColor}},void 0,p().createElement(v.FormattedMessage,e.caption)),shouldWrapCaption:!0}))}):r()(N.Z,{requireUpgradeToTier:Boolean(e.disabledMessage)&&R.M9(this.environment),analyticsName:this.props.upgradeButtonName,renderUpgradeTooltip:()=>e.disabledMessage,tooltipPlacement:W.Z.Placement.Left,onClick:s,onUpgradeClick:this.props.onUpgradeButtonClick,render:(s,a)=>{const{focused:n,...l}=(0,F.Z)(i,s);return p().createElement(E.Z,o()({},l,{focused:n||e.focused,right:this.props.role===e.availableRole.role?r()("div",{style:{width:t.isMobile?16:14}},void 0,u.Z.check()):void 0,title:r()("div",{style:{display:"flex",alignItems:"center"}},void 0,r()("div",{style:{...e.style,marginRight:e.disabledMessage?6:0}},void 0,p().createElement(v.FormattedMessage,e.label)),a,e.availableRole.tag&&r()(L.Z,{desktopStyle:{marginLeft:7}},void 0,e.availableRole.tag)),caption:e.caption&&r()("span",{style:{color:this.theme.mediumTextColor}},void 0,p().createElement(v.FormattedMessage,e.caption)),shouldWrapCaption:!0,disabled:!!t.isMobile&&Boolean(e.disabledMessage)}))}},a)}getItemDisabledReason(e){switch(R.CM(this.environment)){case"personal_free":const{currentSpaceStore:t}=k.default.state;if(h.zz(e)&&!(this.props.isUserPermission&&t&&t.canEdit()))return r()(B.Z,{imageURL:c.Z.images.tooltips.upsells.userFullAccessPng,imageWidth:240,imageHeight:100,caption:r()(v.FormattedMessage,{defaultMessage:"Guests with full access can edit a page and share it with others.",id:"permissionRoleSelect.userEditorUpgradeTooltip.caption"}),title:r()(v.FormattedMessage,{defaultMessage:"Upgrade to grant full access",id:"permissionRoleSelect.userEditorUpgradeTooltip.title"})});break;case"team_free":if((this.props.table===M.bx?h.RN(e):h.J5(e)&&!h.zz(e))&&"public_permission"!==this.props.type&&"bot_permission"!==this.props.type)return this.props.table===M.bx?r()(B.Z,{imageURL:c.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:r()(v.FormattedMessage,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"permissionRoleSelect.spaceReadAndWriteUpgradeTooltip.caption"}),title:r()(v.FormattedMessage,{defaultMessage:"Upgrade to add non-admin members",id:"permissionRoleSelect.spaceReadAndWriteUpgradeTooltip.title"})}):r()(B.Z,{imageURL:c.Z.images.tooltips.upsells.userReadAndWritePng,imageWidth:240,imageHeight:100,caption:r()(v.FormattedMessage,{defaultMessage:"Users with edit access can edit a page but not share it with others.",id:"permissionRoleSelect.userReadAndWriteUpgradeTooltip.caption"}),title:r()(v.FormattedMessage,{defaultMessage:"Upgrade to add editors",id:"permissionRoleSelect.userReadAndWriteUpgradeTooltip.title"})})}return!1}getAvailableRoles(){const{type:e,table:t,isInvite:s,role:a,availableRoleItems:o,blockType:i}=this.props;if(o&&o.length>0)return o;const r=[];return"bot_permission"!==e&&r.push({role:"editor"}),"space"===t&&(0,P.Ri)()&&r.push({role:"membership_admin"}),r.push({role:"read_and_write"}),"collection_view"!==i&&"collection_view_page"!==i||"bot_permission"===e&&"content_only_editor"!==a||r.push({role:"content_only_editor"}),t!==M.bx&&("bot_permission"!==e&&r.push({role:"comment_only"}),"bot_permission"===e&&"reader"!==a||r.push({role:"reader"})),s||r.push({role:"none"}),r}isRemovingSpaceUser(e){return this.props.table===M.bx&&"none"===e}handleSelect(e){this.props.role!==e&&this.handleSelectChange(e)}}const j=z}}]);